data = """##################################################
#.O#..O#.....##.O.O.OO#..OO..OO.......O....O.O.O.#
#.....O.#.....O.#..OO#....O#O..#OO#.#..#OO......O#
#.....OO...#..O.O.........OOO#..O...#O...O.O...OO#
#..OO....O.#...O.O...O....OO............O.OO..O..#
#OO.OO...O#.OO....#....O.OO........OO.....#..O.#.#
#OOO...#....OOO...OOO...O.O.....O..O...O..O.O.#..#
#......O.#O.....#OO............OOO...OO....O.O...#
##....O...#.OO.##.O..O..#.#...#.O..#.....O..#....#
#.O..#.#...O#..OO.OO.O..O..O.O.O...O#..OOOO......#
#.............O.O...O..OO..#...O.O..O..O....O....#
#.O#O.OO..O....O......OO.............O....O..O.#.#
#....O....O.O..........O.##..O.OOO...##O.O.O.O.OO#
##...O...#......#.#..O..O..OO#O...#...OO..#OO.O.O#
#.OO..OO.#.##.OO....O.O.#.OO...O.O.......O.#..OOO#
#.O#OO#.O.O..OO.....O....OO.#O..O.#.....O..#.O...#
#.OO........O.......O.O...O...O.O#......O.O..O...#
#....O...O.OO..#...#.O.#..#..O.OOOOO.....O.#.O.#O#
#.O...#O..#.#.#OO.O...O.##O.O......O.###.O.#O#...#
#.#O...........O.........O...OO.OO#..O......O.OOO#
##.....#O..#....O.O...#O.#.O..OOO#......O.O......#
#O.OO...O..O#....O#O.O....#....O.#.O....O..#.....#
#........#.#....O.O.OOO......OO.#....#.....O...OO#
#O...#.#O..O.OO..O...O.#..OOO.OO....#...O.....#..#
#..O.....OO#O.O....#O..#@...#...#.O....OO....#.#.#
#O.O.#......#O....OO.OO.OO.#..OO.#OO.........O...#
#OOOO.##...#..#OO..O...O..O#O....#.OOO...##....O.#
#.O............O...OO.#........OOO.....O.O..#..OO#
#......O..OO.....OO.O.O...O....O.O.O.#........#..#
#............O#.O.O....O.O.O.#OO.O.#....OOO.....O#
#.O.#..........OOO...O..OOO...#.....O.........O..#
##OOO.O....#OOO.O...O....O..O...O.O#O.OO.O......##
#OOO##.......OO...#.........OO..O....O..#......O.#
#OOO....O.....O.#.O..O.#.......O....O.O..O.O.....#
#.....O....O.OO....OO.OO..O.OOOO..#..O.O..O.O.O.O#
#O..OOO#....#.#..OO.O.#..O#OOO.O...O.............#
#OO......OOO..OO..O.O...##...#..#O..O....O.......#
#...#..O.#O#.O..O....OO.O.....O#.O.....O..O..O..##
#O....O..O.OO#.....O#O.#......OOOOOO.O.#OO...#O..#
#OOO...#O.....OO#O..OOO#...#.........O....O..O...#
#O.#.O.OOOO....O#O...O.....##.OO....O...O..O#.O..#
#.OO.OO.......O..O.O.......OO.#OO..#OO..O.O..O.O.#
##O..............O..#O.....OO.......#O.#.#.O#....#
##...OO..#.O.......O..#.O...#..OO.O..O...#...O.O.#
#..OO#....O.....O..O..O#...#.....O#...O...O..O.#.#
#..O#..OOO.O.O.....OO....O#O...O.O#....OO........#
#..#..O.O.....#...O#.O........O..O.OO.#O#..OO.O..#
#...........O..O....OO..O.......O..O#....O...OO.O#
#.O.O.O...OO......OO....O..OO.....OO#.O.O...OO.OO#
##################################################

>>v>>^<><<><vv<<v><^v>v^<<>vv<<^<<>v<^<<>><<v>>^><>v<v>>>^^vvv^^<v<<^<^<^<^^>^^>^<^v^<>vv><<>v^<^<v^<v<^vv^^<v^<<v^vv<^>v<^<><v>^<v^v^<>>>><>^<v^<<><>>^v>v>>>vv>v^^^>vvv><^^>^v<v<^<v>vv^^v<^>^v<<v>^>><^<<vv<^>><v<>v>><<<^>>v>^^>>vv><<^>^v^^^<>vvv^<^^>^^>v^vvvv>^>vv>v<vv<v^<^^>>^v>^^<v<^><>>v>>>^>^v>^^^v>vv^v^><^^^>>v<^<>v<^^<<>>v>v>^<<>>v^><<vv<<<^^<>^vvv<^<^>>>^><v>>>>^>><<v>^v<>^>^<^<^><<<>v<<>vv^^v>v><>vv<><^^^vvv>^<>vvv>v^^vv^^<^>v>><<<^<^><^><<^>v<^>><>vv<<v<^^><><>^<<v<^^^v<^v>^>><^^^<<^^<^>^^><^vv>vvvvv<^v>>^vv>vv>^vvv^^v><<<>^vv><>^^<^v<v^^v<^<^>^>>>><v<>v><v<><>vv^<^^v^^vv<<>><>^<v^v<>v^^<^><>^>^^vvvv>>^^>^<<v^v<<>v<v<v><<v>v<>v<<<^<^<>>vv<<<^v<>vv>v><v<^vv^><^><^^^^<<>vv>v^^^>>^>>v>v^v^<>>^<>v<^^v>^^vv^>v^v^<>>>>vv>><<^>^<vv>^^^v<^v>v^v><^>vv<>>><v^>><>>vv<^^<<><^v<<^<v<^<>^>^>^>^v<<^v>v<<><><v<><>v<><<><>^v>^v<><<^v>>^^<^^v^^vv>v>^>v>>v<^vv<>>><^><^^>v>><><>^>^<<v<vv^vv<<vv^^vvv^><v^>vv<<v><><>vvvv>^vv>><>^^v<><>>^v<vv<v<>v^>v><v><<v>>>>>><<>>v<<>vvv^^v>v^>v<>>>><^v>v^><><<<
>v^^^><^<><>^>><>v<>vvv>v>>>v<><vv>>vv>>^v>>v>^<^^v>>>^v^<><^<^<<>^<<v^<^^>>><v<<>vv<^v>v<><^v>^vv>vv>^>>>v><<<<>vv<^>v<^^^<>^^vv<><<>^<^v<^<<<^>v^v^<^>>>vv^v>><vvvv><^v^>v^<>><>vvv^<<<<>>v^v<vv><v^vv>><vvv><<>>><>v>vvvvvv>^>vv<v<>^vvv<^v><<vvvv<>v<<><^v^^<v<v<^<^v><^v^v^><>v>><^^<>v<>v>><<^>><^v^>>^^>vv>v><><^>>^v<vvvv^^<>>^>v<v^<v><^^<<^<vvvvv>>>^^^v<^^<<v^vv>>^^v<v<<^<<>v<v<>vv>^<>v>^>>v>v><><>>^<>^v^<><^v^v<<v>>v<>>^v>><><<>v<vvv<<^<>^><<>^>v<<v>^<v><><^>^><<v^<^<v>^>v^><v>>v<v^^^vvv^>>v^<^vv<>><v><<<vv<>v^<<^v><><^>v>^vv^><v>v>^v<>>^^<^<>^v>vvvv<^<v>v<v<>^><v^^^>>>vv>v<^^>v<<><^<<<>>v>>^<<^v>^vv>v<^^^vv>^<<^v<<^v^vv^<v<<>v^<v>vv><^<^>^^<vv^^<^^><^><<v>>>v^^v^>>v<^^v>^>^<>^<>^>><>>^^^v<<^^<>vv^^v^<^>vv<><^^<>>>v<<<^<v^vv<^<vvv><^<<v<<>^v>v^^v<v>>>^^><>>^v^^><<v<>vv^^vv<^<^<v>v^^^^>vvvvv^<<>^^^^^v<^<^^<<>>^^<<<<v<v<<v<>^v^>>><>^<>^<>^<><vv<^>v<^^<v^^^<^>vv<v>v><^^>vv<^v^^v>^<<^v^v<<<vv^v>>>^^v>^<v<<v^^><>v>v^vv>v^^v^^v>^v<><v<><<v<<^^>v>>>>^^<<<<v>><v<><^>v^^>^v^v>v<<>v^>v<>>v^<><>v
^v<<>v^<v>>^<<<^><<v^^^^v^v^<<^v^<<>>>^>v^v<^>><<^<^^^<<^v^vv<^<v<<vv^v><<><>><^v^>v>^v<<<v^<^<^<vvvv^<<^<^<<>^<v^^<^>v<>><>>>vv^>><vv><v>v^>v>^>v^^<^^^<vv>><vv<^^v>^><^<<^><^^^^<<^v<v^>vv>>^v^v^>>^>v<v^<^>v^^vv^<><<v<<<>^>>^^v>>>v><vv<<^>><<^v<^v^><>>^<>vv>>^^^v<v^<v^<v<v^^<<v<vv^<v<^<^vvv>>^v^v<<<^^<<v^<^<^vvv>^>^vv<v^v^<>>>^><<<v^^>^<^>v>^>^v^><v><>v><>>v<><>>^><^><<><>^^>^<<<>><^v^^^>^>^^>^<^>^><<><v<vv^>^^^>^^^v^<v>><<^^v<>^v>>v>v^>^^>^>>v^><^^^^^<<v^v^><<^><v^v^>vv<v<v^v^<^^^>v^>v^^><<<^<<v^^<vv<v^<^<^^<^v^^^>^<>>>v^^^^<>^<vv<vv>v^^>>v^v<<<<<<v^>v^>^^^<<vv^>>vvvv>vv>>v<><>^v>^^vv><<<v^<<v^v>^vv^<<v<v<^><v<vv<^>vvv<<vv^>vv<>>^<<vv>>^^<<>>v^^^^<><v>><v^^>^<>>^<><^<<<vv^<<>^^<^<>^>v<>v<v<<v>^v^>^<^vv>><>^<<><^<<>>^^^><v^v<<^<vvv^<>vv>v^<^><v^v^<>v^v^>^^vv^^^>>^<v>^<<v>^<^<v>v<<v<>v^^<>v<>><^^v<>^v^<>^v<^vv<^vv^<>^v<<<v><vv<^v<v<^v>v>>>^v<<^v^><^>v^v^vv<>v<^>^<^<v^<^^<<>v^<<vv>v<^>v<^>vv^>^><<<<^vv^>>vv^><<>vv<v<vvv<<>v>^v^vv<v<^v^>><v^>^>v<>^<v>vv<<>v<^v>>v^^><>>^<<v^><^>^<<^>vv<<v<
<><>vv^<<>>v^^<<>><^<>>^^>^>^>v<^^><v<^<v>^v<v>v^<<^>vvv^<v^><v>>vvv^<<^<^^<v>><^v^^>^vvv^v>^<^<<v<^<<><v<<^<v^>vv><^<>><v^^<^^>^>>vv<v^<<<^>vv^>>>v<>^^<v>^vvv<^v><v<<^v>^vvv<>^<^<<v>>v>>v>><v<v^v>v>^<^^><>vv>v^<><v<^>>>^^<<>v^>>^v>^^^vv>^v^>>^v<>>><v>^<^v>><^>v<v<v>^>^v<^v<v^vvvv^^^<v>>>v^^^^v<>>^v<v^^^<^^>vv<^^v^v<^^<<<vv>vv^<><vv><^<v<<>v<><>v><<v^vv<^>>^^v^<v<^<><^<vvvv<vv<^v<^^^vv<><^>vv^><>vv>^>^v^<vv<<v<v><>>>v^<^v>vv<^>^^>v>>^vv>><v<><^^<<>>^><>v<^^^>v<^<v>>^vv<>><v>^^^<^v><><<<<>>v^<>>><^<^^v^<<v<^<^^vvv^<vv>v>><vv^>vv<v<vv^<<v<<<vv<v<>><vv>^<>^<v<<>><^v<<^<>vv><>^^>><><<^>><<<<^^^^v>^^^>v^v<<><<>>v<^^>^^^><^^v>>^^>v>v<^^>^^^<^<^<^^v<vv<^>v>^^<<>>^v<<<<<^<><<<v^>>>^v^^<^<>><vv<<<v^<<vv^^<vvv^v^v^^^^vv^^v><v>v>^><>v<<<<^<v<><^v<>^<>v^^v><<^<<^><v>^vv^<<^^^^<<^><>^v>^<<v^<^v>v<^v^<v^>v<vv^vvv^>^>>^>><v<v<^<^^^<<<>vv><><^^v^><>v<v<<^v>v<^<vvv^>v<^>^v^>v<^<^^^^>^>><<v^^^^>^^><>>v^><<^<><>^v>>^vvv^^v<>^<^<^<<^><vv>^v><<><<<<<>v>v>^><v^v><<v<>>>><^>vv^v>v<>^v>^<v<<^<v<^<v<>>^><<v<><
^^^<^^>v><>^<<^v^^v>v><><<^^^^^<<^<vv<<^v>>v^>^<v^<<<^>^>^vv>^^><^>v>v><<<vv<<^^>^><^^<v^^^>v>^<<>>^^^v^><vv^>v^>v<<^>^>v<<>^>>>^<v<>>>^<<<>v<<<<<>><^<<^>^^v<^v<><<v>v><v<>^<<^v^^v^<<<^>><v>>v^v>^v>^<>vvvv><^<<v^vv^^<>>v>^>vv<^v<v^^<^^<^>>>vv>^^<vv^v>>vv<^<^>>^^^><v<><<^<^<<>^^^<^vv^^v>^>v<<v>>v^<v^<vvv^v<v^v>>>v>vv>vvv^>^<^vv>^><<^v^><^vv><<<v>^^v^>^><v<v>^v<^v^>>><v^v^^<<>v^v^^^^v><^<<<^^>><<v^><^>v><>vvv^<^>^><>^vv>v^v^v<<^vvvv>v>v<<^vv<v<vv>v<>v^^<^v^v>^v<vv>^v>v<>>vvv<<vv>><vvv>^<>v>><vv<<v^<<v>v<<<v<^>^^>vv>>^>^v><^<<>v>><<^<v><vv<<vvv^^vv<^>>v>^^>v<<<>v<><^v>v<^<<v^^<<^v^<>^v<>>>^vvv>^<>v>v>>^<v<<v<^>^^v<>^<vv^^<>vvv>>vv<<^v>><vv><^^>v<^v<>v><<>v^>^^<<<v<<<<^vv^<>^^>v^v>>v<><^<><^^><^^v^>>v<v<>>><>v<v<v^>v<<v^^^<^v<v<v^>v>>>^>>v<v>v><v<v>^^v>><>>v><>^>>>^<<vvv>v<<v^^<>v><<<>>v<>v^vv><^<>^v<><>v>vvv<><>>>><<<^<^v^v>^^v^<vv<vv^v^>>><<<>^v^><>><<<>^vv>^v>v>>>>^v^>>^^<v>>>>^^>vv^v^<^v<>v>vv<>v><<><vv>^^^^^vvv>>>^v^vv<<<v>>><v>^^vvv^<<^>^^vv^>>v<^>^>><vvv>><v<^v<<<v<>vvv>v<^^vv<>^^><
<<<<>^^^<>><>^<^<><v<^^^<v<><<<v^^>^^<^><<vv>v<vv>v<v<><>^<><^^^<v^>v^v^^v^>>>^^><^<<^v^v>^v^^<>^<^^v<vv>^>><<>^v<^>vv<><><>><^<>v<v<>^><^<v^v><<v^^><<<^^^v^^^>v^<>vv^^^^^<vvvv<v>>^>>v>vv<>v<^<v>v>vv^>^vv<^<^^<^v>^>>v<<>v<<>v>^<<v>v>>^<vv<>^vv^<^vvvv<v<<v<^^>^v^^<>^^>^v<vvv<v>^v^^<^>^^><<v<<><<<^<><><^^<>^>>>><v<>>><<vv^^v><v>v<^^>><vv^>vv^^<^^v<<<<<><^^<v^v>v^v<<>>v^v^><><>^<^^<^<v<v<vv^^>v^v<<v^><>><<^^^>>^<v^^<<v<<vv^><<^v<vvv>><<vv<<^vv>>^>v>^>v>><v^vv^v<^>^>>^v<<<^^<v><v>>^>vv^<^<><><vv<v^v>><>>>>>>><>^><>v<v>>^><vv><<v^>^^>>v^^>v><>>^vv<>v^<>>v^<><<<<^^vv<>^^^v><<^>>>>>><^>>^<v^^vvvv>v^^<^v>v>v^>v<>^>^>^<^<><v^>>^^v>^>^^<<v<vv>v^^><v>^vv<^>^v<<>>>^^>>>^<^^v^v>^><v>><>^>vv<^>^vv>^vv<^^>^^>vv^vv^^v^^<v<^^<^^^v>v^^^v<^><^>>>v^<^><<^v>v><^<<<><^>^vvv<<<^^>>v^^>><>v>v^v<v>>^v<>v^>^^v^<^>><>v><<v><<<^<>><vv<v<<^<><<>>^<><v^>>vvv>^v><><^><v<v>^^v<^vvvv<>>v<v><>^>v>^<>v<>^><^^v<v>v>>^>^^<<>><^>v^><^^>>>v>>^<^vvv<>^<vv>>vv^>vv<^^><vvvv<^>>^vv^>v^<^<^v>v<>^^<v>v><<^^v^>><>>^^^v^>><<vv<<vv^
>^><><>v^<^>^<><v^v<v<>vvvv<<^^>>>vv^>^vvvv<^<^v<><^<vvv<v^^<>vvvv>^>v<^^<v>v^v<^<^^>v>v^<^><><<v<<^>^<^><v^vvv>^v<^v>^<^^^<<^<v^>><>>^v<^^<>><^>^<>^^>><v<v<v><^<v><v<vv^<<v<>^v<^<<>><>^<<<v>^v^v<^vv><^v^>v>><<<^v<^^^v<>><<>>v>>^^^^<^^<^^>v^<v>^v<<<v^><^v><^><>>v<>><^<>v^v^^^<v^>^><>^v^vvv<^^<>v<<>^vv>v<^^><<<<>><^><<>^^v^v>^>v<^v>v^v>>v>>^^>v^>><>>^^^^^<^><v^v^>>^>^<<>^v^^v^v<^^v^v<^>>><>^v<^^>^vv>v<>^^v<v>><<^^v^^^<>v<^><vv>^^<v^>><>v<v<><><v>^^<^<<<>v<>v^^^v<^>^<>^^v<>^v^^>^><<v<>^><>^>^^>vv<>v<<^^>>vv>vv^<>>>>><><vvvv<^>v^^>>>>><^>>^v><v>v^>^^^<<^vv^>^vv><v<^<<^v^vv><v<<>^<<<^<v^<<>v<>>^vv<^v>^^^v^^^<v<>vvv>^<^>v>v<<v>v>>><v^<v<^^>><<>^^<>v<^v><^^v^^>^vvv^><^v<^>v><^v^v^v<vv^>^v>>v<v><^v^<^<v<<><v><>><>^^^^v<v>><vvv<<>v<^^v<^>v^v^v^^>v>^<v<^^^v>v>^v^>vvv<>^>>>><v<v>^v><vv<vvv>^<>v^<^<v<v>v>>^>^>>^v<vv<v^<<>v^<vv<vv^^<v>><v>^^<v<vvv<^vv^^v^<^<>v^><v<v^v^^v^><>v^v>>^^>><<>vv>^^^vvv>v>vv<>>^v^<^v<<^>^>vv^^>v<v<v^v><^<^>^^^v^^<^<<^^<v<v><>>v^^vv^v^v<<<<>>v^<v<<v><>><>v<>^>v<>^vv^>v<<v<
^^>v^><>^v<<<><vv<<<>v>vv^v>>v^>v^^<^^<<v^<>vvv<>^v><^<<<>><<<<v^v<<<>>^vv^<<<>><<v<^<v<<<v<v>>^<<><v><>><v>^^<><v<<<v>v^><v^v>^v^<><^^>v^^<>^<^<^^>vv><^^^v<<<<>^vv^v<v>>vv<<^<^>>^>><><^>><<^<<v^><v^vv<<>>v<>^v^>>v^>vv^<^v>>><>^<^>^^<<<><v<v^v>^^>^v>^vv^<v^<^vv><<>v^>^^v^>^<>v<<<<v^^v>>v^v<<^^v><^>>^<v<>><v<^v^v<>^^<^^v>^v<<^^<v<>>v<v<^<<<^<v^><^>v^^^<^>>^>><v<>^v>vv>^v^^v<<<^>>^><v>>vv^<^<v<v^v<v>^<>^<>v^vv<v<>^v<>^><^v<>v<^<^v<^vv><<<<v<<<^^v<<v<>v>>>v><^v^^vv><vv>vv>>v^<>^>^^><>>^<^>>v><v^>v^><v>>><^^v<v<<^v<>^^^<<<^^v^>>^<v^<>vv^<v>^v<<^v^>vv^vv^><^^vv>><^>^^^<><^>v<>^v<>v^<<>^v>>><>v^v^>^><><<<>vv<^<v>>^^>^^^^^^v^<>>>>v><>v<v^v^v><><vvv<^^<>v<^><<<v>^>^^>^>><>v>v>^^<><v>^^>v^v>v><vvv^<<v>^<<<v>>v>><<<v^v>v>v>v^>^>>><>v^^^vv^v<vvv^>v>v^^vv><><v>>^v^^<>>v<v<v>v>>><>>v^<>><>>^^^^><<^>>^v^v<>>^^v<vv>v^<><^^><v>^v<<vvv^^^<^<^<vv>>^><>v<v^<>^^^^>v<^^vv<v>><<<>v<v<<>v<v>v^^<^<<>>^v^<v^^v><^<<>v><<<<>^v>vv<v<^>v>v>>v<vv>v>v><^>>^^^>^><^><><<><>^>v<v^^>^>>>>><v^^><v^>><^^vv<<<v>v<>^>^<<v<>
^vv<>v<>^<v>v>^^<^v<<v^^><>>^<<v<>v^<<^v>>^>^<>v<>^v>v>>>^><<^>><v<^^>^>^v^><^vv^v<<v^^^<<^><^<<<>^^><<<>v>^<<v>^<<<>>>><vvv>>>vv^<<^><v><^<v^v<v^v>^>^v<<^vv<^vv^^^vv^<^v^v<>^v><^^^<v<>^^>><<^v<>^<vv>^v>v^>>^^>v>><^v<^<>>><v<v^^<vv>v<<<^<>vv<^><><<>>><^v^<^<vv^>>>>^>v<v<<v>^>^><^^^<^vv<>><<vv<^v>v^v>vvv<^<><v>^v<^^^vv^^^<^v<<<>>>>vv^^^vv><<v^>^>v^^<^<<<^>v<>^<<<<^>><>^><<v<<<v^<<v<vvv<<^^><>^v^<<^^<^<^^v^>><<^>>>vv^vv>>v>>v<<v>vv^<^>v><v>v^>^>>^^v>>v<><>>v><>^vv<^^^>><>v>vv<vv<<vv<vv<<v>v^><v^>^<v<^vv^<vvvv>>>><<^^<^^>v<<<v^vv^<>>>>>^v><><<<><^^v<vv^v^v<>>v^<><<^vv^><vv>v<v>>vvv<^><v>>>^><v>>^^<vv^<^^^<>>>>>v^>vv^<v<>^^^^>^^<<^v>v<<<vvvv<><^<<^<>^><^>><>>><>>>^<^^^vv^>>^<><^vv<<<<v<^>^v>^^v^>^^><v<^v^<^>>v>>>^><<v^v<v^^^^v>>v><^<>>><v^v^v<^^v<<v<<><<^vv<^^<^^^vv><>v^^v>^<v^><<>>vvv^>>^v>><<<>^<>^^<<>v<^><^<vv<<>^>^<<<v><^<<^^vv<vv>vv^^>^^^<>^v<><^v<^>vv>>v>v^^<>v^v^>^^><>^vv>^<v^^<^^<v^^vv>vvv<<>v^^<>vv^v<^v^><<v^<<<>^>>>vv<v>v^><^<^^><^v>^<>v>vv^>vvv<^>v^v>>v^v>^^^<>v^<vv^v^<<>vvv^>^>
<><>^<v^v>><vv>^v<^vv^>^<<>^^><>v>^v>^>^^<>v<>^<><v<^<><><^v>>v<v>>vv><^<>>^^^>>>>v<vv>^vv<v>^<v<>v^><v><>v<^vvv><^v><<^vv^^>>>v>vv^>v<^v>vv^^v<^<v<<^<^>v<vv<>>v^^vv^v^^^^><v<>v<^>>><v<^>><>^^^v^<^v^^^>v>v>>^v^^<^><^^<vv<^^<<^v<^<<<^vvv<><<v><<v^<>^>v<^v><>><><<>>v<^^<<v<<^v><vvvv><^<v<>vv<><vv^>>^^^>><>>^<<<vv^^<>>v^><v<<>>^<>>>v^^^v>><>vv^><^<^vv<<v<<>>v>^v^v^v<<>v<^v><v><<v^<>^^^v>v^<<><^v<vv^vv>>^^vvv^>>^>v^^vv>^vv^>>>><^>v<<^v><<>^v>v>v>>vvvvv<^<<v>>>vvv>>>^<^<^^^<^<><vv>^>>>vv^<^>>><><^v<>v>><<<<>^<><vv^>v^>>^v^<<<^v^v<^v>>^<>^><<>^v<<v^<v<^<<vv><<>vvv^v><^vvvv<><>>^^>>>v<^>^^v><<vvv^>v<v>><^^^<v<>>v<>^v^><<^^<^<v>^>>>^v<^^^>v>^>v^^<v>v>vv^v><>v^><<<^^v^v>v>>><<vv^v^vv^<^>^<^v<^v<^^^v<<v>>v>^^<<^<<^>>><>>>>>v>v>^^^^>^^>>^><>^<v><vv<<<v><<^<><><<>>^^<v><v><<<^^<vv^v^>>^v^^v<^v^>>>^><^><>v<>v<<<^><><vv<<>v^<<v<>^^^v^vvv>v^<v<^^>>><>>vvv<<<><vvvv^<<<^<^^>vv^>><v>vv<^><^^v<<>v>>v<>v<><^<v^v<<^><><<<v<>>^v>>^^v<^><>><<v<^^vv<>>v^<>>v<<^^<<>^><>vv<^<>^v^<<v<v>v><^<^<>>^<>><vvv><<^^v<<<
>^<><v<<^vv<>^^>>>^vv^^^v<>^<^^<^<>v^>>>v<v>>>v^^>^^^<><v<vv<^^<><^v^<<v>>v>>^vv^^>>>^^<v<v>^<<^<>>><>^>>^^v^v>>v>>><>^v<>^^^>^^><>v^^vvvvv>>^v<^<<^<><v<v^v^<>^^vvv^^v>v<>^><^^v<v><<<><v<vv^^v^^>^>^^^vv^<^^^vv<>^v<>v>^<><^^<v^<>^<v>>v>vv<v<^^<>v^^^<v>>^^>v<^>^<^><vv>v><><v>v<^vv>^v<vv^^vvv<vv>^<>>>>v<<vv^<^^<<^^><vv^^>v>^<<^>^>><<<v^><<<><<<v<v>v>^>v><v>>^^<<v<<<^^v^><><^<v>v><^v>v<>v<<^><^><vv^vv^<>^v^<^^^v><>v<<<>^^^><<><^^>^>>^>vv<^><^>^^<^^v>vvv^v>^^>>^v^v<vvv^v^<^^vvv<>^>^^^>^^>vv^<<<<v^><v<^><>>^<^><^<v<<vv>>v<^>v><^<>^<>v^v>^<v><^<>v>>vv><>v<>v^^^vv<vv^<v><<^<<<<v^^^v^>>>vv>^>>vv^^v>v<^^><^><>^>^<^^><v<>>^>v<<v><v>v<<><>>^v^vv<^v>v><>vv>^><<>^><vv>>v<>v^><><^^<>>><^<<^>v>^v<v<^^>><v^^<vvv<^^^><v>v>^^v<<v^^^>>>v>>^><>>v>>^<<<^^^<^^>v^^<^>^><>vv>><>^v<<vv^>v><>^v><v<<><<^<v^v^<<v<v<^<^v^<^>^vv<^>^^>^<v>^>^v>>><>^vv<v<v>><<>><v<^^<v>v><>>v><<vv^v<<<>><v^>vv<<<><><vv^^^>^vv^^v<<><^>v^>v<<v^v<vvv^>^^>vv<^vv<^<<^<<v^v><v>>>v>^<<<^>^v>^vv^<v^v<v>vvv^^<v<^><<^^v^>^<^^<>^>^^<v^^^v>>><^^>
v^^>v<<v<>vvvv<>^>^<<vv^<<>><^^<>v^>^v<^v^>>>>>>^<><<v<<<v^v^>><^^^<><v^>vv^vv>^<<>^^>^v^^v^><>v<<^<>>>v<<^>>>>^<>>><<v>>>><<v<>v<>>v><vv<<v^>^^v><^<><<v^>v^>v<vvv^>v>v<vv>vv>><v>^vv<v>><<<<vv^><<^>^v>^<^>v^v^>^^>^vv^v>vv^^^<<<v<<<<v<vv<<v>v<<v>v><v<>^v<>^v^>^<<>>v<v<vv><>>v>^><<vv<>vvv^v>><v><>^^<<>v^^><<^<>^>>^<>>><v<vv^>^<^>>v^>^^^<v<>v>v^<>><>>><^<vv>vv^v^><^<<^>v^^>^<>>^vv><>^v^^<><>v>v>^v<^<^<vv<v>^v>><>>><v><<<><vv^^>v>>^vv^v<>^<<^^v>v>v<v^v<^>>v>>><vvv<v>>v><>^v<><v^<<^>><v^>v<<<<><<^<>vv^vv<>>vvv<vvvvv^^><v>^>^^vv^v<vvvvv<>>v^<^<>>^<^v><<^<<vvv>>>v><>^v<^<vv^<<<><v<vvv>vv<><^<vv>^<v<^v<^vv<v<<>>>v^>v<<>>v>^<^>vv^>>^vv<>v<^v<<^v<v><<>^^<v^>^^vv^^^v><v><>^v>^><<>>v><v><><>v><>>v^^>>>>>^v>^>^v<>v><^>vvv>>v^>^^>><v><^^v>^vv<^><<>^v><>>><><>^><>^vv<<v<<>>^v^<v><<v<<^^>^^<<><>v><>v^<^^>><<><v^^v>>vv<vv<^>v<v>>^v^>^<^v<^v<<>>^<>vv^>v^<^>><vv>^>^vv<><v<>>>v<v^^<><<^^^<<v>>^<><><<v<<v^vvvv^<<<v<<><v>><>^^v^>>v<^^<<^vv>^<v<^v>^><^^<>^<^^>><<<><v><^><^<<>^v>^<><<^^^>^^<>v^<v><^^>^v<^^>v>
><>>v<<<^<<vv<^^<<<v<>^v^vv<vv^<<>vvv^<^<>>v^>^>^^v><>v^><<vv^>^^v^v<>><<>v^>v<^<vvv^>vv^<>>><v>v<^^v<^v^v<<^<vv>v><>^>v>>v<^^>>v<^><><<v^>^<<vvvvv^<>^<<<v^<v>^^vv^<^^<<v^^<v<<v^vv^<vv^<v^^^v^v<v^<<>>^<v>>><v^><v^>>^^v<<>^>v^vv^>><>^<><<^<^<v><>v>v^>v^v<^<<<^<<><^v>^<>^>>>v^v>^<<>^>>v>v<v^v<v>>^<^v<>vvv^<<vv>>>>^^vv>^^>^v><<<<^<>^>^>>>>>^^>^<<^v><vv<<^>^<<<^v>><><^>v>>^<<v^v<>^<<vv^>^>>>><^vv>>vv^v^^>>^^^<vv^^>><^<^^^>><<<<>><^<^v^v^vv<<>v><>^^>>><^^v<vvvv>^><^<v<v^v<v<<>v^v^>>^^vv^^vv><>vv>^v><>v^>vv<v^>^>vv>^v<>>^><v><<v>>>^>vvv^<>>^v<^><vv><v<<>^v<vv>v^^v><<>^>v>^^<v><><^>><v^v>^><<v><vv^>v>^^vv<v>^><v>v<<<<<^^>^><><v<v^<>vv><^>>>^>^v><<<>v^<^^<<>><^^<^<^<v^v>>^v>^><><^>^^<v<^<<>^>v<<v<>v<<vv>^^v^v<v^v<v<vv>v<<<<^v>vv>v^<<^>><>>><^>>><^^<>v^^<>>><>vv^>>vvv><><<><^<v<vv^v>^>v>^>v>>^><<^v<^<<><^<^<^v^v<^^<<^<>^<<<^vv><><v^<<<^<<>>^^<^^<v^<^^>^^^vv>>vv^>v><>^v>vv^^>>>v>v^v^^^><>^>v>vv<v>v^>^vv>^v<^^^^>^v<^v<<^><^^^v^v^<v>v^<^><<^<v<>>><>>>>>>v<v<>^>^>vv><^^>^<v<^^>vv>v^^v^<<vv<><^<^<<^
v<v^>^><<>vv^vv^v<<^^v>^>>^>^>vvvv>>v<^<<><<>><<<<^^^v>v>vvv<^<v><><><^>^v^><^^^^^v><v>>v^^vv^<v<^><v<>^><^<^<<<>>><>^>>^<<v<<v>^^^>^^v^^v^>>^>vv<<><v<^<<<^vv<v<<>^^v>>v<v>^v>>v<>v<^v<<^v<vv^><^>v>v>vv^>^^<<>^^^v<<^>>><<<v>^v<<^^<<<^>v>>v>^^v^^v^^v>^^<<^><<<v>v><<>>vv<^^<^^v^^v^^<<<<<>^^<v<^><v^<v><>>v><>^v<v^v<v<^>v<>v^v^<<<^^>v>vv^v^<<^^^^v><^^^<<>^^<><^^v^^v<^v>v<<<><^<^><v>vv<<<^>vv><^vv<<>^<vv<^^vv><^<<>^vv>v>>^><^v^vv<^v<<<v^^<>^><<v<vv<^<><^^<^<v>^<>>>^^^v<v<^v>v^<v<vvvv><><^^v<^>v^v^><<>^v>^>v^^v^^>vv<vv^<^>vv>v>^v>>^<<v<>><v<^<>^^<>><vv^v<>vv^^<<v<v>v^<^vv^^<^>>^^<v^^<^vv>>vv>^<>v<>vv>v<^^vv^<<v^<<>v>>v<>^><>^v>v<<<<<<^<v^^^>v^^<^><v<>^^<^<v<^<<<v><>v<^^v>^vv^>>>>^v>^<<>vvv>v<^^<><<>vv^><^v^v>^<v<v<<<v^v<^v<^v<vv>^^>v>v<v>v>><><>^v>v<<>^vv<><^^<>v<v^^><^>><vv<>^v>v^v><v>^v^^<>v^^v>^^v^vv<>v<<>>^v<vv<<<v^^>v^>^^v<^<v<^v>^>v<>^^^v<^^<^><><>^>v>v>^<vv>^<^<^vvvv^^v<^^><<<^>^v<<<vv^>v^>^v<v>>><v><v^>v^><^<>><^vv<^>>^>^^<v^<>^^v^^v^vvv>v><v>>^<<>^<<v^<><v^>v><>^>^<^<>>v<>v^^><v><><<
^^>>v<v^vvv>^v>^^^>^vv<<v><^^^><<>v<<v^v<<^^<<v<><^>>>v>vv><>>^v^v<v<^vv^v>>v<<^<^v<v^^>vv>>v<<^v<><v<>>>vv^<v>v>><>><<v^>>^v>v>^>>^^^^<v>><<><^vvv^>>^>><vvv<vvv><<v>^^<<^<<<>^vvv><v>><<v<v<><v<><<>^><^^>^<>>^>>>>^^v<>>^^^v>>vv<>>>>^<v^>><^v^<^^<v><v^>^vvvvv^v^^><<^v>vvv^^>>>^<<>^<>^^v^^>>^>>v>^>>^^^v<^<>^^vv>>v^v>^^^>v<<^v>^<>v>^>^vvv>v^<^<^<v><>><<v>v^><<<^<^^<v^v>^v^<<^>vv^<<v><^<^>>>^v>>vv<><^>>>>^v<<><v<<<>vv><^v<^v<v^^><>>v>v><^v<^v<><><^v>^><>^^^<^^vv<<<>^>>><v^^>v^<>vvv<>^<v<<v<^<><v^<<^<^>vv>><^<^>^<v>v<^<>v>><^^>>v><<^^>>>>^>^<v<vvv<<<<>^^^<^v^^<<vv>vvv<>v>>^v>>>^>v^v^^>><<><vvv>>^^^vv^^>v>v^v^>>v<<<vv>^v<vv>>v>v>^<<>^vv>^vv<<vv>^vv^^>>><><>>v^^>vv^^<<<><^v>v<^^^<v^>^>>v<^><vv^<v>v<<v>>^>^^vv^v^vv>^^>vv><v^v>>>^^^^>>v>>v>^>^^<^^^<>v<><^v^^v^vv^>v<v^^>^v^><>v>v^v<v><^^v^>v><<^<>v^v>>^^v<>^v>vv^v^>v<><^^>>^<^><^^>^>^>>v^^<<>^><>^<^>><<>^<<>>v^^v<v^v>v>>^^<<<v<<>>^>>>>>^<<><^>v<><>v^><<<><>v<<vv^v^>>v>><>><^<<vv^v>>^^^><^^v^^>^^v>>^^><vvv<^^vv<v<^v>>v<v<>^><^>>^^vv^^<^><v^^v<><^
>>v>^^<<><^^<>><^<>^v^v<^v<v>>v><>>>^^vv><^vv>v^>^<^^<^<<^vv^v^<<^^<>>^<>^^^>><v><<v><^<>vv^>>>><vv<>v>v^>>>^v^vv><^<v<>^v^v^<^v>>^<><>>^v>v<<^v^vvvvv<v^v<<><vv>v<><<<^>^<<><v<^>^<<<v<>>>v<<<v>><<v^<^<^>v^>v<<<<v^^><vv^<>v<v^^<>v>><^>v<^>v<v>v<v>v<>^<v<^<<v><vv^^>^^>>^vv<v<<^v^^>^vv^v<<<<v<v^v><v>>v^<v>^^^^v>v<^^>^<>>^<vv<>v<v<vv>^v^>v<<<>v^>>v>>^v<v^^vv<>v^^<>>v<<<^v<>^>^<^>v>>^^^^><<v<<><<>v<><<^<v<><>v>vvvv<vvv^^<v>v^><v<<v>>v>>v>v<v>>vv<^v<<^>vv>vv<<v><>v>>>><^><>vv>v^<^>vvv><>>v><<>^>^<v^<<>>>>>>^vv^<^<><>>><vv<>^v^<v^v^>>>v^<<^^^<>v<^>^>>^^<>^^>vv><^^^^><<>v><>vv<^<<v<>^<><^><vv>v^v^>v<>>v>^>v^v^<<^>v<<<>vv^<^<v<><>><^v^^>vv<>>^<>^^^^>>v^<<<><^^v>^^<<>^<>>v>^<vv^^^v^<>^<>v<<<^^^>vv>^<^>v<><<v^^^^<v<<<^vv^^<<v>^>>^<<v>v>v>>>>v>v^><vv>><vv>v<><v>>><^^>^v<><<vv>v><<v>v<>vv^>^<vv>>v<<^^^<<>^><v<>^^v>v<>>v^>><>^<>^>^>v>v<v<v^><><vvv<>>>^><vv>v><<<v<>^^>vvvv>v>^v<><v<v^vv^>><<><^<<<vv><v>><<>^v>><^v^v<v^v^vv^^>vv>^v<v^^>vv^v^v<v^^^v<<<^<<vvvv^vv^^^v>>^vvv<vv>^><^v^v><^>v<^<<^vvv^^><v>^
^<v<^vv><^^v<><v<^><<v<v>v^>^^<>^^<v^v<^^>>^v><<><<<vvvv<^v^>><^<><^<^<^><^^v<><>^v^^>v<>vv^v<^>^vv^v><^<>v^<<vv>>><v>><v>^>><<<><^^<v<^vv^<^v<v><><v><>^^><<v><^^v>><vv>v<v^>v^>^v><^^<>^v^>>^><^<v<<>v^<vvv^^<^<<><<><<^^v>v<<v>>v<^<>^v^><<<<><^><<vv><<<vv<>v<>^v<<^>^>v>v^><^>>vv>vv<<v<>^^v<<v>>^>><>>>vv^^v^>vv^v>^<<<<^^<vv<>><><^>^<vvv>v>^<v><>^vv>vv^><v<v<^<^^v<^^vv<>^^<v<>v>^^<v^>>^<<^^^^>v^><^<v^>^^>>^<>>>><^<^<v^v><<v>>>v^vv<^<><^^v^<^v<>v<^^^>v^vv^^v>><<vv^v>^<^>v<^>^^^^>vv<vv<>^v<^>^<vv^>vv>^v>>><>><<vv<^<<^>>^<v^><v>v^^vv^>><<>^v^>vv<<>><vv<><<>vv<v<>v<<<<^><<v<>><^v><<v^^^>vv><vv<<v>v<^^><vvvvvv>v^>v^v^v^<>^v<vv^^^<^vvv^>><<>vv^v><v><>vv>v>>v^>vvv>v<vv<^<>v>^^<^v^^v^^<>>>v<><>v>v<vv<>>v^v^><<^>^^^^^><><^>^v^^vv^>^^<<^>vv^^<^<<>^v^v<<^<>^v>^<<<><v<v<v^vvv<<^>v>>^^<>>>^>^^v^v^^<><>><v^>^<<>v>>^^>v>^>^v<^^<>^<v>^<<<^<<>>^^><v>><^^v^vv>>^<v>vvv><^v<<v^>>>^^v>vvv>v>>>v^>^<v<^^<v<^>><<v>vv>vv<<^v<<>v>>>^v^<<v>v>>^vv>^v<vvv<^^v^>>^><^vv<^vv^<^><v^<>^<>^^^v^v<v^<>vv><vv<>vv^^v>>^>vv>v^^
<><^v^^^><>>vv><><>><<>^^>^<<v>^v^>^>^><^<^vv>>v<^^>v<<<<<<v>^^^<^v>><>^>>>vv^^>v^v^^v>>><<<<>^>>^<<>v<<vv<vv^v^^^>v^v>v^<<<^>><v><^>^<v^^>v><^<<v<>^^<>^<^>><><<^^<^vv<v^^>>^^>><v<vv>>v^<^>>v<^^<>^<>>vvvv><<v<>v>^>^<^<^<<><^^v^>>v><^<^>^v><^>>^<v^v^^>v>^<^>^<vv^<<^^<>>^<<<v^vv^>v>^^<<<>><<^^v>><^><<^v<^><<<vv<<><<>v<>v^^<^^v<v<v>v^><v<^^>^v>^<v>v>>>>^<^<>^<>>>v<^<<^^v><v>><><<^<>^^v>>^>^^>vv<<^>>v<^>><<v^<<<v^<<<<>vv>^^<vv^<<^v^>>v<^^>>^><^v<^v^v<^^v^v^<><><^<<v<>v<><^^<<<>v>^v^<<vv^>v>^v<<^>^^<v<^<v<<>v<v<<<>v>^>>>v<><<>><>>^>v^><<<<vvv>v^>^>vv^<<<v>^>>^<>vv^>^>><<>^^^^<>^^<^>>^^^v^vv<>><>>^^>^vv<v<^<vv><>>><v<^v><v><><>>>^>><v<>vv^v^<v<<<v<vvv<><^>>>v^^v<<v>^vv^<^<^<>^^v>>><vv<>^<><>>>^<>vv^^>^v>>>v>>v>>>v^>>>^<<v<v^<^v^^<<^<<>^^<>>>^>^>>>>>^>>^vv^^^<>>v<>vv>v^^>^v>><<>v^<v>^<v^vv><vvv^<v<>^<><^v^>><v>v<v>^<><>>>v<v^>>>vvvvvv<v<<^^>v^v>>>^^^><v^^v>>^^>>^^>v<vvvv>><<^>v<><<<vv><^^>>v>^vv^^^v<<^^>^>^>^^^^v>><vv<v<><^><<^<v>v<>>>>v<>v<^v<<<>>vv^<v<>>><<><^<^^v<v^>^^>v>^v><<v<v>>v>^<<<^>
<>^^>>^v>vv^v^<v><><vvvvv<v^>>^>^v>^>v^<>>^<^v><^<>v^>>>^^^><<>v>^<^^<<<vv<v^><>>^<v^<<>^^^>^>^<<v><^^<v<><<^>^<<<^v>>>^^v<>vvv>v>^v><>>>vv^v<>^>^vv^>^^vvvv^v^>>v^<<^v^^><v><<v>^><>>v^v>^^<v>^^^v<>v<<^>vv>^>><<<^^><>>v^vv><><<^>vv^<v^^^<<>v<<^>^>^<<v>^v><vv><>^^<v><<^<^^v<>>^^vv>vv<><^>v>v><vv<<^>v^>v>^>^<v><<><^v^^v<<vv<^><v<<^><v<>v^v<>v^<<^<^<^^v>>><>^v^>^^<>v<<v>^^v><^<v<<v<^<<>vvv><v^v<^v<^vv<^>>v>^v>^^v<>v^v><^<>v<>>v>>v^v<v^>^v<v><<><^<v>>>>>^v^^^vv^v>^<v<^vv<>^<^^>^v>v<v^^vvv^<^>^>v<<>^vvvv<^<^v^v>^^>^v<<>^>^>^^>^>vvv^v>>vv<^<><vv><>>v^^>^v<v<<><<>>v>>><v>vv>><v<><<>v<<^<v<>><v<<<^>>>>v<v><<<v^v^>vv<^vv>^>v<>>^><>v^<^<^^v^^>v^^>><<<>>>^^v>^^^^^^<>v^<>>^<^<v^^<v>v<<v>^<v^v<v<<>>>^v>v^^<><>><><>^<<>^><^^><^^vvv<v<<^<>^^^><^<<<^^>v<<<vvv<>^v<^<^vv^v^><vvv><>>>>^v^vvv<vvvv<v<v<v>v<>v<>^^^v>^^<><<v^<>v>>vv<>v<<^^>vvvv^<<>v^^^^^vv^^vv<>><>v<v^^v^><^v^>>^v>^vv<>v><>vv>v<<v>v>><vvv><^vv^vv>>>^^^<^v>^v<v^^<^v>v^vv^>v<<<v>v<^<v<v^>v>^vv<<vv^<<<>v<v^<v^v<v^vv^vv<>^v><v^^^<^v<^^vv^>^v^<><^
^^>vv<^^vv>^>^^><><>><><<^vv><<><>>^<>>^^vvv<vvv<^^<<^^>^><v>>>^^vvv^>><<>>^><^<<>^<<^>v<v^<v^>^v>v>><^^>vv>v^><<v^<<>^>>vv>^vv<>v^>>^<>>^<vv<>^>>^><<<^>>v<>^>^>>vv^<<^^v^<v>v^v^<>^^>^><<>>><<^v^v^>><>^v^>v<>>>^v>vv^>><<v^>v>v<>^^^v>><vv<^^>^^>^>><<^<^v<^<<v>v><>>vv><v>^v^^^^>v<>^vv^v>^^v<><<<v>>^<^<<<v<<^^<<<>v><v<><^^><>v^^>v<><<vv^>v>^>v>v>vvv<vv^^v^><><<<^>v<<<<<>>vv>vv^v<<<<<>^>^>^><^v>>^^<<<<<^v^vv><^v^vv<vvv^v<^>>^^vv<<^v>v^^>v^v><^<<>^^^^<>v<v^<^<><vv>^><^>><^^>>^^^>v<>^<v>v>^v>>^v<^>>>^>><<<v>^<v^v<v><^v>>v<vv<^v^<^>^v<>>>^>>^>>^>>>>>^>^><vv>v><<^<<>><<<v^<<>v<>>^^<><<vvv^>v^><^>v<<^<>vv^><<^v<<<>vv><>v>>v<^>^<^^<<^<^vvv^<^<><^>v<^<<>>v<<^>>>>^<<v><vvv<^>>^v^<<^<^v>^><v<><>>>^v>vv^^<v<^^>>><<v^^v<<>><^><<<v^v^v><^>^<>><>vv^><^<>>v<<^>vv>^v><<^^vv<<v<^^^<^<<><>>>v<vv<v<^^v>>v<^>v<<^><<v<^^^><^<v<<>>v><^>v>v>vv<v^^<v<<><^>v>^>v<><v<^<vv^<<v>>><^>vv^>^<v>>><><v<^v<<v^^>^^v>>^>^>vv^<v<v^><<>^^vvv><>><v^<<<^>^>^<>>><v<><^>^^vv<^v>>><^v<>>^>^^^^>^v<>v>>v>v>>vv<>vvv>>v<>v<<vvv<<^v><^""".split("\n\n")

# data = """########
# #..O.O.#
# ##@.O..#
# #...O..#
# #.#.O..#
# #...O..#
# #......#
# ########

# <^^>>>vv<v>>v<<""".split("\n\n")

#data = """##########
##..O..O.O#
##......O.#
##.OO..O.O#
##..O@..O.#
##O#..O...#
##O..O..O.#
##.OO.O.OO#
##....O...#
###########

#<vv>^<v^>v>^vv^v>v<>v^v<v<^vv<<<^><<><>>v<vvv<>^v^>^<<<><<v<<<v^vv^v>^
#vvv<<^>^v^^><<>>><>^<<><^vv^^<>vvv<>><^^v>^>vv<>v<<<<v<^v>^<^^>>>^<v<v
#><>vv>v^v^<>><>>>><^^>vv>v<^^^>>v^v^<^^>v^^>v^<^v>v<>>v^v^<v>v^^<^^vv<
#<<v<^>>^^^^>>>v^<>vvv^><v<<<>^^^vv^<vvv>^>v<^^^^v<>^>vvvv><>>v^<<^^^^^
#^><^><>>><>^^<<^^v>>><^<v>^<vv>>v>>>^v><>^v><<<<v>>v<v<v>vvv>^<><<>^><
#^>><>^v<><^vvv<^^<><v<<<<<><^v<<<><<<^^<v<^^^><^>>^<v^><<<^>>^v<v^v<v^
#>^>>^v>vv>^<<^v<>><<><<v<<v><>v<^vv<<<>^^v^>^^>>><<^v>>v^v><^^>>^<>vv^
#<><^^>^^^<><vvvvv^v<v<<>^v<v>v<<^><<><<><<<^^<<<^<<>><<><^^^>^^<>^>v<>
#^^>vv<^v^v<vv>^<><v<^v>^^^>>>^^vvv^>vvv<>>>^<^>>>>>^<<^v>^vvv<>^<><<v>
#v^^>>><<^^<>>^v^<v^vv<>v^<<>^<^v^v><^<<<><<^<v><v<>vv>>v><v^<vv<>v^<<^""".split("\n\n")

#data = """#######
##...#.#
##.....#
##..OO@#
##..O..#
##.....#
########

#<vv<<^^<<^^""".split("\n\n")

warehouse, instructions = data[0].splitlines(), "".join([row for row in data[1].splitlines()])

from collections import deque

# Bidirectional Dictionary (hashmap)
class BiDict:
    def __init__(self):
        self.__heads = {}
        self.__tails = {}
    
    def add(self, head, tail):
        if head[1] > tail[1]:
            head, tail = tail, head
        self.__heads[head] = tail
        self.__tails[tail] = head
    
    def contains(self, key):
        return key in self.__heads or key in self.__tails
    
    def isHead(self, key):
        return key in self.__heads
    
    def isTail(self, key):
        return key in self.__tails
    
    def get(self, key):
        if key in self.__heads:
            return self.__heads[key]
        elif key in self.__tails:
            return self.__tails[key]
        raise Exception("key not in bidict")
    
    def remove(self, key):
        if key in self.__heads:
            tail = self.__heads[key]
            self.__heads.pop(key)
            self.__tails.pop(tail)
        else:
            head = self.__tails[key]
            self.__heads.pop(head)
            self.__tails.pop(key)
    
    def items(self):
        for key in self.__heads.keys():
            yield key


walls = set()
objects = BiDict()
for r, row in enumerate(warehouse):
    for c, char in enumerate(row):
        if char == "@":
            robotPosition = (r, c*2)
        elif char == "#":
            walls.add((r, c*2))
            walls.add((r, c*2+1))
        elif char == "O":
            objects.add((r, c*2), (r, c*2+1))

def isEmpty(r, c):
    return (r, c) not in walls and not objects.contains((r, c))

# method used to check if we can push an object in this direction
def canPushObject(nr, nc, dir):
    if dir == (-1, 0) or dir == (1, 0): # up or down
        currFrontier = deque([(nr, nc)])
        while currFrontier:
            sq = currFrontier.popleft()
            partnerSq = objects.get(sq)
            nextSq = (sq[0]+dir[0], sq[1]+dir[1])
            nextPartnerSq = (partnerSq[0]+dir[0], partnerSq[1]+dir[1])
            if nextSq in walls or nextPartnerSq in walls: # there is a wall in front of this object
                return False
            if objects.contains(nextSq): # it is an object
                partnerOfNextSq = objects.get(nextSq)
                if nextPartnerSq == partnerOfNextSq: # it is actually the same object! (an object pushing one object)
                    currFrontier.append(nextSq)
                    continue
                else: # pushing a different object
                    currFrontier.append(nextSq)
            if objects.contains(nextPartnerSq): # it is an object, and we know that it cannot be the same object we found before
                currFrontier.append(nextPartnerSq)
        return True
    elif dir == (0, 1): # right
        for c in range(nc, len(warehouse[0])*2-1, 1):
            if (nr, c) in walls:
                return False
            if isEmpty(nr, c):
                return True
    else: # left
        for c in range(nc, 0, -1):
            if (nr, c) in walls:
                return False
            if isEmpty(nr, c):
                return True
    return False

# method to push the objects in this direction, given we can do it
def pushObjects(nr, nc, dir):
    if dir == (-1, 0) or dir == (1, 0): # up or down
        sqs = []
        visited = set()
        currFrontier = deque([((nr, nc), 1)])
        
        # find all the objects to move
        while currFrontier:
            sq, lvl = currFrontier.popleft()
            if len(sqs) != lvl:
                sqs.append(set())
            if sq in visited:
                continue
            visited.add(sq)
            visited.add(objects.get(sq))
            sqs[lvl-1].add(sq)
            partnerSq = objects.get(sq)
            nextSq = (sq[0]+dir[0], sq[1]+dir[1])
            nextPartnerSq = (partnerSq[0]+dir[0], partnerSq[1]+dir[1])
            if objects.contains(nextSq): # it is an object
                partnerOfNextSq = objects.get(nextSq)
                if nextPartnerSq == partnerOfNextSq: # it is actually the same object! (an object pushing one object)
                    if nextSq not in visited:
                        currFrontier.append((nextSq, lvl+1))
                    continue
                else: # pushing a different object
                    if nextSq not in visited:
                        currFrontier.append((nextSq, lvl+1))
            if objects.contains(nextPartnerSq) and nextPartnerSq not in visited: # it is an object, and we know that it cannot be the same object we found before
                currFrontier.append((nextPartnerSq, lvl+1))
        
        # update the objects bidict
        for level in reversed(sqs):
            for sq in level:
                partner = objects.get(sq)
                objects.remove(sq)
                objects.add((sq[0]+dir[0], sq[1]+dir[1]), (partner[0]+dir[0], partner[1]+dir[1]))

    elif dir == (0, 1): # right
        sqs = []
        for c in range(nc, len(warehouse[0])*2-1, 2):
            if objects.contains((nr, c)):
                sqs.append((nr, c))
            if isEmpty(nr, c):
                break
        for sq in reversed(sqs):
            partner = objects.get(sq)
            objects.remove(sq)
            objects.add((sq[0]+dir[0], sq[1]+dir[1]), (partner[0]+dir[0], partner[1]+dir[1]))

    else: # left
        sqs = []
        for c in range(nc, 0, -2):
            if objects.contains((nr, c)):
                sqs.append((nr, c))
            if isEmpty(nr, c):
                break
        #print(sqs)
        for sq in reversed(sqs):
            partner = objects.get(sq)
            objects.remove(sq)
            objects.add((sq[0]+dir[0], sq[1]+dir[1]), (partner[0]+dir[0], partner[1]+dir[1]))

directions = {"<":(0, -1), ">": (0, 1), "^": (-1, 0), "v": (1, 0)}
for i, instruction in enumerate(instructions):

    # get next location
    direction = directions[instruction]
    nextLocation = (robotPosition[0]+direction[0], robotPosition[1]+direction[1])

    # we are heading to a wall, skip this turn
    if nextLocation in walls:
        continue
    # we are trying to push an object
    if objects.contains(nextLocation):
        if (push := canPushObject(nextLocation[0], nextLocation[1], direction)): # if we can push an object
            pushObjects(nextLocation[0], nextLocation[1], direction)
            robotPosition = nextLocation # move the robot
    else:
        robotPosition = nextLocation

total = 0
for r, c in objects.items():
    total += r*100 + c
print(total)