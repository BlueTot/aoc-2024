data = """DDDDDDDDDSSSSSSSSSYWYYPPPPPPPEWEEECCRRRRROKKKKKKKKKKKKKKKKMMMMMIMMMIIIIIIIIIIIIIIIIIIIIIIIIIIVVVVVVVVVVVEEEETTTTTWWWWWWWWWQQQPBPPPPPPPAAAAAJ
DDDDDDDDSSDDDSSSSSYYYYPPYPPPEEEEEERRRRRRKKKKKKKKKKKKKKKMMMMMMMMIMMMMMMMIMIIIIIIIIIISIISIIIVVVVVVVVVVVVVVVEEEETTWTTWWWWWWWWWQQPPPPPPPPAAAAAJJ
DDDDDDDDDDGDDSSSSYYYYPPPYYPPEEEEEERRRRRKKKKKKKKKKKKKKKKKKEMMMMMMMMMMMIIIMMIIIMIIISSSIISIIVVVVVVVVVVVVVVVEEEEEEEWWWWWWWWWWWQQPPPPPPPPAAAAAAAA
DDDDDDDDDDDDDDSSSYYYYYYYYYYPEEEEEEEEEERRKKKKKKKKKKKKKKKKKMMMMMMMMMMMMMMMMMMMMMMMSSSSSSSSVVVVVVVVVVVVVVVVVVVEEWWWWWWWWWWQQWQQQQPPPPPPATAAAAAA
DDDDDDDDDDDDDDSSSYYYYYYYYYYYGYEYEEERRRRRKKKKKKKKKKKKKKKKKKMMMMMMMMMMMMMHMMMMMMMMKSVVSSSSVVVVDDVVVVVVVVVVVVEEEWWWWWWWWWWWQQQQQQPPPPPPPAAAAAAA
DDDDDDDDDDDDDDSSSYYYYYYYYYYYYYNYEEERRRRRRKKKKKKKKKKKKKKDMMMMMMMMMMMMMMMHMMMMMMMMMSSSSSSSSVVVVLVVVVVVVVVVVEEEEEWWWWWWWWWWQQQQQQPQQAPPAAAAAAAA
DDDDDDDDDDDDDDSSSYYYYYYYYYYYYYYYOOERRRRRRUKKKKKKKKKKKKDDDMMMMMMMMMMMMMHHMMMMMMMMSSSSSSSSSSLUULVVVVVVVVVVVEEEEEWEEBWWWWWWQQQQQQQQQAAAAAAAAAAA
DDDDDDDDDDDDDDDDDYYYYYYYYYYYYYYYOOYCRRRRRKKDKKJKKKKKDKDDDDDMMMMMMMMMMMMMMMMMMMMMSSSSSSSSSSLLLLLVVVVVVVVVVVVEEEEEEBWWWWWQQQQQQQQQQQQAAAAAAAAA
DDDDDDDDDDDDDDDDDYYYYYYYYYYYYYYYYYYYYDRRRRMVVVVKKKKKDDDDDDMMMMMBMMMMMMMMMMMMMMMMMSSSSSSSSSLLLLLLVVVVVZZVVVVEEEEFEWWWWWWNQQQQNQQQQAAAAAAAAAAA
DDDDDDDDDDRDDDDDDDYYYYYYYYYYYYYYYYYYYDRRVRVVVVVKKDDKKDDDDDMMMMBBBBMAMMMMMMMMMMMIMSSXVVSSSSSLLLLVVVZVZZZYVVSSEEEFFFWWFWWNNNQQNNQQQQQAAAAAAAAA
DDDDDDDDDDDDDDCDDDYYYYYYYYYYYYYYYYDDDDRRVRVVVVVVKDDDDDDDDDDMMMBBBMMAMMMMMMMMMMGMMSSXVSSSSSLLLLLLLVZZZZZZZZZSEEFFFFFGFFFNNNNNNQQQRRRAAAAAAAAA
DDDDDDDDDDDCCCCCWYYWYYYYYYYYYYYYYYDDDDRRVVVVVVVVVDDVDDDDDDMMMMMMMMMMMMMMMMMMMMMMMMVVVVSVVSLLLLLLLZZZZZZZZZZZZRRFFFFFFFNNNNNNNNRRRRRRAAAAAAAA
DDDDDDZDDDDCCCWWWWWWWYYYYYYYYYYYYYDDDDDDDVAVVVVVVVVVDDDDDDMAAAAAMMMMMMMMMMMMMMBMVVVVVSSVVSSSLLLLZZZZZZZZZZZZZRRRFFFFFNNNNNNNNNRRRRRRAAAAAAAA
DDDDDDZDDWWWWWWEWWWWWYYYYYYYYYYYYYDDDDJJJJJVVVVVDDDDDDDDDDMAAAAAAAAAAAMMMMMMMMVVVVVVVVVGVVSSLLLSSZZZZZZZZZZZZRRRFFFFFNRRNNNNNRRRRRRRAAAAAAAA
BBBZZDZZZWWWWWWWWWWWWKYYYYYYYYYYYYDZJJJVVVVVVVVVDDDDDDDDDDMAAAAAAAAAAAMMMMMMMMVVVVVVVVVVVVSSSSSSZZZZZZZZZZZZRRRRRFGFFFFRNNRRRRRRRRRRUAAATTAA
PBBBZZZZWWWWWWWWWWWWYKYYYYYYYYYYYYZZJJJJJVVVVVJOODDDDDDDDDMAAAAAAAAAAAUMMMMMMVVVVVVVVVVVVVVSSSAZZZZZZZZZZZZZZRRRGGGFFFRRRRRRRRRRRRRRUAPPAAAA
BBBBBBZZZZIIIWWWWWWWYYYYYYYYYYYYYZZZZJJJJVVVJJJOODDDDDDDDMMAAAAAAAAAAAUUMMVMMVVVVVVVVVVVVVVVSSAZZZZAAZZZZZZZZZYYFFFFFFRRRRRRRRRRRRRRRRVVVFAU
BBBBBEIIIIIIIIWIWWWWYYYIIIIIYYYYZZZZZJIJJJJJJOOOOODDDDDDDDMMMMMMMTMMUUUUMAVVVVVVVVVVVVVVVVVVVAAADDAAAAZZZZZZZZZYYFFFFFRRRRRRRRRRRRRRRVVVVVAU
BBEBJXIIIIIIIIWIWWWWYYIIIIIHHYYIZZZZPJIIJJJJJOOOOOODDDDDDMMMMMMMMTTHTTUUUVVVVVVVVVVEEEVVVVVVAAAAAAAAAAAZZZZZZZYYYYFFFFRORRRRRRRRRRRRRGVVVVAA
JJBBJXXXIIIIIIIIWWYYYYIIIIIIIWIIIIZZIIIJJJJJJOOOOOOODDDDDDMMMMMMMMTTTTUTTTVVTVVVVVVVVEEVEVVAARAAAAAAAAAAAZZZZZYYYYYFFFSOWWWRRRRRRQQRGGVVVVVV
JJJBXXOXXIIIIIIIWIIIYYIIIIIIIIIIIIIZIIIIJDDDDOOOOOOODODDDDMMMMMMMMMATTTTTTTTTTNNVVVVVEEEEEVAAAAAAAAAAAAGZZZZZZYYYYYFFFSOWTRRRRRRQQQQQVVVVVVV
JJJBXOOXXIIIIIIIIIIIIYIIIIIIIIIIIIIZIIIIDDDDDDOOOOOOOODDMMMMUMMMMMLTTTTTTTTTTNNNVVVVEEEEEEAAAAAAAAAAAAAAZZZZZZYYYYSSSSSWWWWWWRRRQQQBQQVVVVVV
JJJXXXXXIIIIXIIIIIIIIIIIIIIIIIIIIIIZIIIIDDDDDDOOOOOOOOOOXIMMUMMMMMMTTTTTTTTTTTTTGGVEEEEEEEEAAAAAAAAAAAAAZWEAEEEYYYYWVSWWWWWBRRRRQQQQQQQQVVVV
JJJXXXXIXXIIXXXIIIIIIIIIIIIIIIIIIIIIIIIIIDDDOOOOOOOOOOOXXIMUUMMMMTTTTTTTTTTTTTTTTGVVEEEEEEEAAAAAAAAAAAAAZZEEEEEYEYEWWWWWWWBBRRRRQQQQQQQQVVVV
JNJJXXXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIIIIDDDOOOOOOOOOOOXXXUUUUUUTTTTTTTTTTTTTTTTTTGGEEEEEEEEAAAAAAAAAAAAAEEEEEEEEYEIIIIIWWWBBBQQQQQQQQQQQQVV
JNNNXXXXXXXXXXXXXXIIIIIIIIIIIIIIIIIIIIIIDDDDDOOOOOOOOOXXXOXUUDUUUTTTTTTTTTTTTTTTGGGGEEEEEEEEAAAAAAAAAAAAAEEEEEEEEEEIIIBBBBBBBBBQQQQQQQQQQQVV
JNNNNXXXNNNXXXXXXXIIIIIIIIIIXIIIIIIIIIIIDDDDDOOOOOOOOODXXXXDDDTTTTKKTTTTTTTTTYYGGGGGGEEEEEEEEAAPPPAAAAAACEEEEEEEEEEBBBBBBBBBBBBBQQQQQQQQQQVV
JNNNNNNNNNNXXXXXXXIIIIIIIIIIIIIIIIIIIIIICCCOOOOOOOOOODDDXXDDDRRKKKKKTTTTTTTTTTYYGGGEEEEEEEEEEAAPPPPPAAAAEEEEEEEEEEESBBBBBBBBBBQQQQQQQQQQQQQV
JFNNNNNNNNNXXXXXXGIIIIIPIIIIIIIIIIIIIIIIICOOOOOOOOOODDDDDDDDDRRRKKKKKTTTTTTTTTYGGGGGCEEEEEOOPAPPPPPPPAEAEEEEEEEEEIIBBBBBBBBBBBBBBQQQQQQQQQQQ
JFFFNNFNNNNAAXXAAIIIIIIIIIQQQQQIIIIIIYIICCCCOOOOOOOOODDDDDDDDDKKKKKKKKTTTTTTTYYYGXGCCEEEEOOOPPPPPPRPPAEEZEEEETTTTTTTBBBBBBBBBBBBBQQQQQQQQQQQ
JJFFFFFFFNAAAXAAAAAIIAAAIIIIQQQIIIIIYYICCCCCCOOOOODOODDDDDDDDDKKKKKKKKTTKKTTTYYYXXCCPPPPPOOOPPPPPPPPZZZZZWWEETTTTTTTBBBBBTTTTTBBQQQQQQQQQGGG
FFFFFFFFFFFJAAAAAAAAAAAAAIIATQTKTTIIIYYCCCCCOOOOODDDDDDDDDDDJJJJKKKKKKKKKKKKYYYXXXCCCCPPPPPPPPPPPPPPZZZZZZEEETTTTTTTBBBBBTTTTTBBQQQQQQQQGGGG
FFFFFFFFFFWJAAAAAAAAAAAAAIAATTTTTTTTTYYYYYCCCOOPPPDDDDDDDDDTJJJJKKKKKKKKKKKKYXYXXXXCPPPPPPPPAPPPPPPPZZZZZZEEETTTTTTTBBBBBTTTTTBBBQQQQQQQQGGG
FFFFFFFOOWWJJAAAAAAAAAAAAAAATTTTTTTTYYYYYYYYCOOPPPDDDDDDDDDTJJJKKKKKKKKKKKKKXXXXXXXXPPPPPPPVPPPPPPPPPZZZZZZAATTTTTTTEEBBBTTTTTBBQQQQQQQQGGGG
FFFFFFFFFFWWJAAWAAAAAAAAAAAAATTTTTTTTYYYYYYYYYYPPPPDDPDDDDTTTTTTTKKKKKKKKKKKKXXXXXXXXXXPPPPPPPPPPPPPPPPZZZCAATTTTTTTTTTEBTTTTTKKQQQQDQQQGGGG
FFFFFFFFFWWWWWWWAAAAAAAAAAAATTTTTTTTTTTTYYYYJJPPPPPPPPDDTTTTTTTTKKKKKKKKKKKKKKXXXXXXXXXXPPPPPPPPPPPPPPPPZZCAUTTTTTTTTTTTTTTTTTBKKKQKDDQQGGGG
FFFFFFFEFFWWWWWWAAAAAAAAAAATXTTTTTTTTTTYYYYJJJPJPPPPPDDDTTTTTTTTTTKKKKKKKKKKKXXXXXXXXXXXPPPPPPPPPPPPPPPPZZZAATTTTTTTTTTTTTTTTTBKKKKKKKKKGGGG
FFFFFFFFWWWWWWWWWWAAAAAAAAATTTTTTTTTTATYHJJJJJJJPPPPPDDDDTSTTTTTTTKKAKKJKKKKXXXXXXXXXXXPPFHPPPPPPPPPPLPPPZAAATTTTTTTTTTTTTTTTTBBKKKKKKKKGGGG
FFFFFFFFFWWWWWWWWWAAAAAAAAAATTTTTTTTTAAYHHHHJJJJJPPPPDDDDTDTTTTTKKKTTTKXKXXXXXXXXXXXXXPPPFHPPPPPPPPPPPPPPAAAAAATTTTTTTTTTTTTTTVKKKKKKKKKGGGG
FFFFFFFFXWWWWWWWWWWAAAAAAKKATBBTTTTTTHHHHHHJJJJJJPPDDDDDDDDTTTTTTTTTTVKXXXXXXXXXXXXXXPPPFFFFFPPPPPPPPPPPPPAWAAABEETTTTTTTTTTTTKKKKKKKKGGGGGG
NNNFNNNNWWWWWWWWWAAAKKAKKKKKKKTTTTTTTTTHHHHHJJJJDDDDDDDDDDDTTTTTTTTTTVVDDRDXXXXXXXXXKXPPPFFFFPPPPPPPPPPPPPPWAAABEETTTTTTTTTTTAKKKKKKKKGGGGGG
XXNNNNNNWWWWWWWWWWAAKKKKKKKKKTTTTTTTHHHHHHHJJJJJJDDDDDDDDDDTTTTTTTTTTTTDDDDDXXXXXXXXXXPPFFFFFPPPPPPPPPPPPPPWAAAEEEAATTTTTTTTTAAKKKKKKKKGGGGG
XXXXXNNNWWWWWWWWWGKKKKKKKKKKHHHHHTHHHHHHHHHJJJJJJDDDDDDDDDDTTTTTTTTTTDDDDDDCCCXXXXXXXXXPPFFFFPPPPPPPPPPPPWWWWWBBEEEETTTTTTTTTKKKGKKKGGKGGGGG
XXXXXXNWWWWWWWWWWGKKKKKKKKKHHHHHHHHHHHHHHHHHJJJJJDDDDDDDDDDTTTJJJJTTJDDDDDUDCCXCXXXXXXPPPFFFFFPPPRPPPPPPWWWWWWBBEEAATTTTTTTTTJDKGKGGGGKGGGGG
XXXXXXWWWWWWWWWWWKKKKKKKKOKHHHHHHHHHHHHHHHJJJJJJJDDDDDDDDDTTTTJJJJJJJDDDDDDDCCCCCCCXXXPPPPPFFFFPPRRPPRRPWWWWWWWBBEAATTTTTTTTTJKKKKKGGGGGGGGG
XXXXXXXXXNWWWWWAAAKKKKOKKOOHHHHHHHHHHHHHHHHHJJJJDDDDDDDDDDTTTTJJJJJJJDDDRRRRCCCCCCCCXXPPPPPFFFFPRRRRRRRRRWWWWWWBBHHAAAAAHJJJJCCCKKBBBGBBGBGG
XXXXXXXXXNWWWWWAAAAKAAOOOOHHHHHHHHQHHHHHHHHJJJJJJJDDDDZDTTTTTTJJJJJJDDDDRRRRRCCCCCCCXPPPPPPPFPPPRRRRRRRRRRWWWWWBBBHHHHHHHJJJCCCCKKKBBBBBBBBB
XXXXXXXXXXWCWWAAAAAKAAAOOOHHHHHHHHHHHHHHHHHHJJJJJJDDDDZDTTTJJJJJJJJJDDRRRRRRRRCCCCCCXXPPPPPPPPPPRRRRRRRRRRRWBBBBBHHHHHHHHHJJCCCCCCCBBBBBBBBB
XXXXXXXXXXCCWAAAAAAAAAAOOHHHHHHHHHHHHHHHHHHHJFFFFFFDIIITTTTTKKKJJJJDDDDRRRRRRRQCCCCCZPPPPPPPPXPRRRRRRRRRRRRRRBBBHHHHHHHHHHHCCCCCCCBBBBBBBBBB
XXXXXXXXXXCCAAAAAAAAAAAOOOOHHHHHHHHHHHHHHHHJJFFFFFFIIIIIIIIIKKIJJDDDDDDRRRRRRKQXCCCZZZZXPPPPPXPRRRRRRRRRRRRRBBBBHHHHHHHHHHHCCCCCGGBBBBBBBBBB
XXXXXXXXXXCCAAAAAAAAAAAAOOOHHHHHHHHHHHHHHHHHJFFFFFFMIIIIIIIIIIIEJDDDDRRRRRRRRQQQHCCZZZZXXXXXXXXRXRRRRRRRQQRRBBBHHHHHHHHHHHHCCCCGGGGBBBBBBBBB
XXXXXXXXXXCAAAAAAAAAAAAOOOOOOHHHHHHHHBHQHHJJJFFFFFFFIIIIIIIIIIEEJBBRRRRRRRRRRQQQQZZZZZZXXXXXXXXXXRRRRRRRQRRRBBBBBHHHHHHHHHOHCCCGGGGGBBBBBBBB
XXXXXXXXXXXDJJJJJJJJAAAOOOOJHHHHHHHHHHHQQQYYYYYYFFFIIIIIIIIIIIEEERRRRRRRRRRRRQQQQZZZZXXXXXXXXXXXXXRRRRRQQQQRBBBBHHHHHHHHHHHHCCCCGGGBBBBBBBBB
XXXXXXXXXAAAJJJJJJJJAAOOOOOJHHHHHHHQHQQQQFYYYYYYFFIIIIIIIIIIIIIEEERRRRRRRRRRRQQQQQZZZXXXXXXXXXXXXXXXQRQQQSSSBBSBHHHHHCHCCCCCCGGGGGGGGNBBBBNN
XXXQXXXXXFFAJJJJJJJJAOOOOQOOHHHHHQQQQQQQPFYYYYYYFFFIFIIIIIIIIEEEEEEEERRRRRRRRQQQQQZZZXXXXXXXXXXXXXXQQRQQQQSSSSSBSSCCCCCCCCCCCGGGGGGGGNNBBBNN
XXXQXQQFFFFAJJJJJJJJAOOOOOOOLHHHHQQQQOQPPFYYYYYYFFFFFIIIIIIIAEEEEEEEEERRRRRRRRQQQZZZZXXXXXXXXXXXXXXXQQQSSSSSSSSSSSCCCCCCCCCCCCCGGGGGGGNNNNNN
BXQQQQQQQFFFJJJJJJJJOOOOOOOOOQQHQQQQQQPPPPYYYYYYFFRFIIIIIIAAAEEEAEEEEERRRRRRRRQQQZZZZXXXXXXXXXXXXXXXXQSSSSSSSSSSSSCCCCCCCCCCCCGGGGGGGGGNNNNN
QQQQQQQQFFFFJJJJJJJJOOOOOOOOOOQQQQYYYQQPPPYYYYYYYYYYIIIIIIAAAAAEAEEEEEERRRRRRRZZZZZZZXXXKXPXXXXXXXXXXSSSSSSSSSSSSCCCCCCCCCCCYCGGGGGGGGNNNNNN
QQQQQQQQFFFFJJJJJJJJAOOOOOOOOQQQQQQYPPPPPPYYYYYYYYYYIIIIIAAAAAAAAAEEHEERRRRZZZZZZZZZZZXXKPPPXXXXXXBXXSSSSSSSSSSSSCCCCCCCCCCCCCCGGGGGGGNNNNNN
MQQQQQQFFFFFJJJJJJJJJJJJJJJJJJJQYYYYYPPPPPPPPPYYYYYYIIIIIAAAAAAAAAEHHEERRRRZZZZZZZZZZZLLPPPPPPDDXDDDDHSSSSSSSSSSSCCCCCCCCCCCCCCGGGGGGGGGNNNN
MQQQQQQFFFFFJJJJJJJJJJJJJJJJJJJYYYYYYPPPPPPPPIYYYYYYIIIIIAAAAAAAAAHHHHERKRRZZZZZZZZZZZPPPPPPPMDDDDDDDHSSSSSSSSSSSGCCCCCCCCCCCCGGGGGGGGGNNNNN
QQQQQQQQFFJJJJJJJJJJJJJJJJJJJJJYYYYPPPPPPPPPPYYYYYYYCIIIIIAAAAAAAAAHHHEERRZZZZZZZZZZZZPPPPPPPPDDDDDDDHHSSSSSSSSSSGGGCCCCCCCCCCGCGGGGGGNNNNNN
QQQQQQQQFFJJJJJJJJJJJJJJJJJJJJJYYYYYPPPPPPPLLYYYYYYYCIIIIAADAAAAAAAAHHHERRZZZZZZZZZZZZZPPPPPPDDDDDDDDDHHSSSSSSSGSGGGCCCCCCCCCCCCCGGGGGGNNNNN
QQQQQQQFFYJJJJJJJJJJJJJJJJJJJJJYDYYYYYPPPPLLPYYYYYYYCIIJJJAAAAAAAAAAHHHEHRZZZZZZZZZZZZZOPPVVPDDDDDBDHHHHSSSSSSGGGGGGGCCCCCCCCCCWCCGGGGGNNNNN
QSSSSSFFFFJJJJJJJJJJIIIIIEEEEEYYYYYYYYYYPPLLLYYYYYYYCCCCCJJJAAAAAAAHHHHHHRZZZZZZZZZZZZZOOOVVVDDDDDDDHHHHHHSGGSGGGGGGGGGCCCCWCWWWWCWNNNNNNNNN
SSSSSFFFFFJJJJJJJJJJJIJIIEEEEEEYYYYYYYYYPPKLLYYYYYYYCCKCKAAJAAAAAAHHHHHHHRZZZZZZZZZZZZZOOVVVVVDDDDDHHHMMMMMMGGGGGGGGGGGGWCWWWWWWWWWWWWNNNNNN
SSSSSSSYYFJJJJJJJJJJJJJEEEEEEEEYYYYYYYCPPPLLLYYYYYYYCCKKKAAAAAAAAAHHHHHRRRZZZZZZZZZZZZZOOHHHHVHDDDHHHMMMMMMMMGGGGGGGGGWGWWWWWWWWWWWWNNNNNNNN
SSSSSSSLYFJJJJJJJJJJFFJJEEEEEEWYYYYYYYCPPPPMMYYYYYYYCCCKKAAAAAAAAHHHHHHRRRZZZZZZZZZZZZZHHHHHHVHHHDDDHHMMMMMMMGGGGGGGFFWWWWWWWWWWWWWNNNNNNNQQ
SSSSSSSLYYJJJJJJJJJJJJJJEEEEEEWWYYYYYYCPPPPPPYYYYYYYCCCKKAAAAAAAAAHHHHHHHHZZZZZZZZZZZZZHHZHHHHHHHHDHHMMMMMMMGGGGGGGGWWSWWWWWWWWWWWWNNNNNNNMQ
SSSSSSSSYYJJJJJJJJJJJJJJJEEEEEEWWWWWYLNBNNPPCYYYYYYYCCCCKAAAAAAAAAHHHLLQLRZZZZZZZZZZZZZHHZHHHHHHHHHHHHMMMGGMGGGGGGGGWWSWWWWWWWWWWWWNNNNNNSQQ
SSSSSSSJJYJJJJJJJJJJJJJJJJJEEEEWWWWNNNNNNNNPPCCCCCCCCCCCCAAGGXAAAAHHHPLQLLZZZZZZZZZZZZZHHHHHHHHHHHHHHHMMMMGGGGGGGGGMWWWWWWWWWWWWWWNNNNNNNNQQ
SSSSSSSSJYYYYYYYYYJJJJJJJJJJJJEJJJWNNNNNNNNNYCCCCCCCCCGGGAGGGGAAAAHHLLLLLLLRBBPPPPPPHHHHHHHHHHNHHHHHMMMMMMVGVGGPGGGGWDWWWWWWWWWWWWNVNNNNNNQQ
SSSSSSSSJJYYYYYYYYYYJJJJJJJJJJJJJJWNNNNNNNCCCCCCCCCCCCCGGGGGGGAMMGTLLLLLLBBBBBYPPPPPPPHHHHHHNNNNHHUUUVVVVVVVVVVGGVGGWDDWWWWWWWWWWWVVVNNQQQQQ
SSSSSSYJJYYYYYYYYJJJJJJJJJJJJJJJJJNNNNPPPPCCCCCCCCCCCCCCGGGGGGAMGGTTLLLLLLLBBXYYPPPPPPPPHHHHVNNNHHUUUVVVVVVVVVVVGVVVVDDWWWWWWWWWWWVVVNNNQQQQ
SSSSSSYYJYYYYYYYYYJJJJJJJJJJJJOOOOOONNPPPPPPPXXXLCCCCCCGGGGGGGGGGGGGBLLLLLBBYYYYYPPPPHHHHHHUVNNNUUUUUUUUVVVVVVVVGVVVDDDWWWWWWWWWWVVVNNQQQQQQ
SSSSSSSYYYYYYYYYYYJJJJJJJJJJJJOOOOFFFFPPPPPPPXXXXXCCCXGGGGGGGGGGGGGBBBBLBBBBYYYYYYPPPHHHHHUUVNUUUUUUUUUVVVVVVVVVVVVVDIDDDDWWWWWWVVVVNNQQQQQQ
SSSSSSSYYYYYYYYYYYJJJJJJJJJJJJJWWOFFFFPPPPPPPPPSSSSSCXGGGGGGGGGGGGGBBBBBBBYBBYYYYYPPPYHHHHBUUNUUUUUUUUUJVVVVVVVVVVVDDDDDDWWWVWWWVVVVQQQQQQQQ
SSSSSSYYYYYYYYYYYYYJJJJJJJJJJEEWWOFFFFPPPPPPPPPSSSSSSGGGGGGGGGGGGGGBBBBBBBYYYYYYYYYYYYYHHEUUUUUUUQQQQQQVVVVVVVVVVVVDDDDDDWVVVVVWVVVVQQQQQQQQ
SSSSTTYYYYYYYYYQQQQJJJJJJJEEJEEEWOFFFFPPPPPPPPPSSSSSSGGSGGGGGGGGGYGGBBBYYYYYYYYYYYYYYEEEEQQQQQQQQQQQQQQFVMVVVVVVVVVDDDDVVVVVVVVVVVVQQQQQQQQQ
USSSTTYYYCCYYYYPQQQQJJJEEEEEEEEEOOFFFFPPPPPPPPPXSSSSSSSSSSGGGGGGGGGBBBYYYYYYYYYYYYYOYEEEEQQQQQQQQQQQQQQFFFVVVVVVVDDDDDVVVVVVVVVVVVVVQQQQQQQQ
USSSTTTTTTTYYYYQQQQQQEEEEEEEEEEFFFFFFFPPPPPPPPPXSSSSSSSSGGGGGGGGBBBBBBBYYYYYYYYYYYOOOEEEEQQQQQQQQQQQQQQFFFVVVVVVVFDDDDVVVVVVVVVVVVVVQQQQQQQQ
SSVTTTTTTTTTYQQQQQQQQEEEEEEEEEEFFFFFFFPPPPPPPPPXSSSSSSSSGGGGGGGGGBBBBBBYYYYYYYYYYYOOOAAAAQQQQQQQQQQQQQQEFFFVVVVVVFFFRVPVVVVVVVVVVVVVVVVQQQQQ
STTTTTTTTTTTCCCCQQQQQEEEEEEEEEEFFFFFFFPPPPPPPPPKSKSSSSSSSGGGGGGGGBBBBBBBYYYYYYYOYOOOOOAAAQQQQQQQQQQQQQQTTTFFFFVVFFVVVVVVVVVVSVVVVVVVVVVVQQVV
TTTTTTTTTTTCCCQQQQQQQEEEEEEEEEEFFFFFFFFFFPPPPPPKKKSSSSSSSGGGGGGGGJBBBBBBBOOOOYYOOOOOOOQQQQQQQQQQQQQQQQQTTTTTFFFVVFVVVVVVVVVSSSSSSVVVVVDQQQVV
JTTTTTTTTTTCTCCQQQQQEEEEEEEEEEEFFFFFFFFFFPPPPPPKKKKSSSSHSGHGGGQBBBBBBBBBBOOOOOOOOOOOOOQQQQQQQQQQQQQQQQTTTKTTFFFFFFFFVVVVVVVSSSSSSVVVVVDVQVVV
JTTTTTTTTTTTTCQQQQQQEEEEEEEEEEEFFFFFFFFFFFFFFKKKKKKKSSSHHHHGGGHBBBBBBBBBBOOOOSSSSOOOOOQQQQQQQQQQQQQQQQCTTTTFFFFFFFFFFVOOVSSSSSSSSSVVVVDVVVVV
JTTTTTTTTTTTTCQQQQQQQEEEEEOOOOOFFFFFFFFFFFFFFCKKKKKKKSHHHHHRRGHHBBBBBBBBALOOSSSSSOOOAAQQQQQQQQQQQQQQQQTTTTFFFFFFFFFFFFOVSSSSSSSSSDDDDDDVVVVV
JJJTTTTTTTTTTCQOQQQQQEEEEOOOOOOFFFFFFFFFFFFFFKKKKKKKKKNHHHHHRHHHHHBBBAABALOSSSSSSOHOAAQQQQQQQQQQQQQQQQCTTTFFFTTTFFFFFFOOTTSSSSSSSDDDDDDDVVVV
JJTTTTTTTTKTTCQOOQQQQEEOOIOOOOOFFFFFFFFFFFFFFKKKKKKKKKHHHHHHHHHHHHBBBAAAALOOSSSSHOHQQQQQQQQQQAAAAAQQQQCTTTTFTTTTTTFFFOOOTTSSSSSSSDDDDDDDDVDV
JJJTITTTTKKKTXOOOQQQEEEOOOOOOOOFFFFFFFFFFFFFFKKKKKWWWWHHHHHHHHHHHHHBBAAALLLOSSSSSLLQQQQQQQQQQAAAAAACCCCTVTTTTTTTTTQFOOOOTTTSSSBBBBDDDDDDVVDV
JJJTIIRTTKKKXXXXXQQQPYOOOOOOOOOQQQZZZTFFFFQFFKQQHHHHHWHHHHHHHHHHHWVVBAALLLLOOOLLLLLQQQQQQQQQQAAAAACCCTCTTTTTTTTTTMCOOOOOOOOOBBBBBBDDDDDDVDDD
IIIIIIITTIKKIZXXXXDYYYOOOOOOOOOOQQZZQQQFFFQQQQQQHHHHHHHHHHHHHHHHWWWVWWALLLLLOOLLLLLQQQQQQQQQQAAAACCCCTTTTTTTTTTTGCCCOOOOOOOOOODDDDDDDDDDDDDD
IIIIIIITIIIIIZXXXXYYYYOOOOOOOOOQQQQQQQQFQQQQQHHHHHHHHHHHHHHHHHHWWWWWWWAWYLLLLLLLLLLQQQQQQAYAAAAAACCCTTTTTTTTTTTTGGCOOOOOOOOOOOODDDDDDDDDDDDD
IIIIIIIIIIIIIIXXXXYYYYYOOOOOOOOQQQQQQQQQQQQQQRHHHHHHHHHHHHHHHHHWWWWWJWWWYLLLLLLLLLTQQQQQQYYYAYAAACTTTTTTTTTTTTTTTTCCOOOOOOOOOOODDDDDDDDDDDDD
IIIIIIIIIIIIIXXXXYYYYYYYYOOOOOOQQQQQQQQQQQQRRRHHHJHHHHNHHNHHHHWWWWWWWWWWYLLLLLLLLLTQQQQQQYYYYYYAYCTTTTTTTTTTTTTCTCCCCCFOOOOOOOOODDDDDDDDDDDD
IIIIIIIIIIIIIIXXXYYYYYYYYYYYOQOQQQQQQQQQQQQRRQHHJJHHHNNNNNNNHHWWWWWWWWYWYYLLVLLLLLTTTTTTYYYYYYYYYYYTTTTPATTTTTTCCCCCCCCCOOOOOOOODDDDDDDDDDDD
IIIIIIIIIIIIXXXXXXYYYYYWWWWQQQQQQQQQQQQQQQQRQQJJJJHHHHNNNNNNNNWWWWWWWWWYYVVLVLLLLLTTTTTTTYYOOOYYYYYTTTAAATZZTTCCCCCCCCOOOOOOOOOODDDDDDDDDDDD
IIIIIIIIIIIIZXZXZXYYYYYWWWWWQQQQQQQQQQQQQQQQQQQEEJJJHHNNNNNANNWWWWWWWVWWVVVVVTTLLLTTTTTTYYYOYYYYYYYYTTTAAATTTCCCCCCCCOOOOOOOOOOOOXXDDDDDDDDD
IIIIIIIIIIIIZXZZZYYYYYYWWWWWSSQQQQQQQQQQQQQQQEEEEEEJJJJNNNNAAWWWWWWWWVVVVVVVVTTLTTTTTTTTTTOOYOYOYYYYTTAAAAAAACCCCCCCCCOOKOOOOOFOBUUDDDDDDCDD
VVIIIIIIIIIIZZZZZYYYYYWWWWWWWWQQQQQQQQQQEQEEQEEEEEEEJJJJNNNNAWWWWWWWWWVVVVVVVTTTTTTTTTTTTTOOOOOOOOYYYAJAAAAACCCCCCCCCCOOKOOOKKOOUUUUUUDDCCCC
VVIILIIIIIIIZZZZZZYZZWWWWWWWWWWQQQKQQQQQEEEEEEEEEEEEJJWWWWWWAWWWWWWWWVVVVVVHVTVTTTTTTTTTTOOOOOOOOOOYYAAAAAAAACCCCCCCCCOOKKKKKKUUUUUUUCCDCCCC
VVVIIIIIIIIZZZZZZZYZZWWWWWWWWWWQQQWQEEEQQEEEEEEEEEEWWJWWWWWAAAWWWWWWWWVVVVVVVVVTTTTTTTTTTOOOOOOOOOOAAAAAAAAACCCCCCKCKKKKKKEKUKUUUUUCCCCCCJCC
VVVVVIIIIIZZZZZZZZZZZZZWWWWWWWWWQWWEEEEQEEEEEEEEEEERWWLWWWWAAWWWWWWWWWVVVVVVVVVTTTTTTTTTOOOOOOOOOOAAAAAAAAAACCCCCKKKKKKKEEEKUUUUUUUJJJJJCJJC
VVVVVVVIINZYZZZZZZZZZZZWWWWWWWWWWWWEEEEEEEEEEEEEEWWWWWWWWWWAAAAWWWWWWWWVVVVVVVVVTTTTTTOOOOOOOOOOOOAAAAAAAAAAACACCKKKKKKKKEEEEUUUKKUJJJJOJJJJ
VVVVVVVIINZYZZEVPVVVZZZZWWWWWWWWWWWWWEEEEEEEEEEEEEWWWWWWWWWAKAAAAKEKWRRVVVVVVVVVITTTTOOOEEOOOOEECAAAAAAAAAAAAAACKKKKKKKEEEEEEEKKKKKJJJJJJJJJ
VVVVVVVVMMMMZEEVVVVVZZZZZZWWWWWWWGWEEEEEEEEEEEMMMEEWWWWWWKKKKKAKKKKKRRRZVVVVVVVVTTTTTOOOEQEOOEEECAAAAAAAAAAAAAAAAAAKKKKEEEEEEEKKKKKJJJJJJJJR
VVVVVVVVMMMMJVEEVVVVVVVVVWWWWWWGGGEEEEEEEEEEEEMMMEEEWWKWWXXXKKKKKKKKRZZZZVVVVDDDDDDTEEOEEQEEEEEMEQQQAAOAAAAAAAAAAAAKEEEEEEEEEEKKKRRRRJJJJJRR
VVVVVVVMMMMMVVVVVVVVVVVVTWWWWGGGGGGGEEEEEEEEEEMMMMEETKKKKXXKKKKKKZZZRZZZZVVVVDDDDDDTEECEEEEEEEEMEEAAAAOAAAAAAAAAAAAKEEEEEEEEEEEKKRRRRRRRJBRR
VVVVVVMMMMMMMMVVVVVVVVVVVVGGGGGGGGGGGEEEEEEEDDMMMRRETTTKKKKKKKKKKZZZZZZZYVVVVDDDDDDDEEEEEEEEEEEEEEOAAZOOAAAAAAAAADDLWWWWEEELEILKRRRRRRRRRRRR
VVVVMMMMMMMMMMMVVVVVVVVVVGGGGGGGGGGGGGEEEDEDYDMMMMEETTTKKKKKKKKKKKKZZZZZZVVVDDDDDDDDEEEEEEEEEEEEEEOOOOOOOAAALALLLDDLEEEEEELLIILRRRRRRRRRRRRR
VVVVVMMMMMMMMMVVVVVVVVVVVVGGGGGGGGGGGGEEDDDDDDMMMMTTTTKKKKKKKKKKKKKZZZZZZZDDDDDDDDDEEEEEEEEEEEEEEEOOOOOOOOOOLLLLLDLLLLLEELLLLLLLRRRRRRRRRRRR
VVVVVMMMMMMMMMVVVVVVVVVVVSGGGGGGGGGGGEEDDDDDDTDMMMTTTTKKKKKKKKKKZZZZZZZZZZZZDDDDDDDEEEEEEEEEEEEEEOOOOOOOOXLLLLLLLLLLLLLLLLLLLLLLRRRRRRRRRRRW
VVVMMMMMMMMMMMVVVVVVVVVVVSGGGGGGGGGGSDDDDDDDDDDTTMTTTKKKKKKKKKKKZZZZZZZZZZZDDDDDDEEEEEEEEEEEEEEEEOOOOOOOLLLLLLLLLLSLLLLLLLLLLLLLLRRRRRRRRRRR
VVVVMOOMOMMMMBBVVVVVVVVVVSSSGGSSSSGSSSDDDDDDDDDTTTTTTTKFFKKKKKKKZZZZZZZZZZZZDDDDDDDEEEEEEEEEEEEEOOOOOOOOLLLLLLLLLLSSSLLLLLLLLLLLLRRRRRRRRRRR
VVOOOOOOOOMMPBPPVVVVVVVSSSSSGGGSSSSSSDDDDDDDDTTTTTTTTTTLFFKKKKKKKKKZZZZZZZIIDDDDDDDEEEEWEEEEEEEEKKKKOOOOLLLLLLLLLLSSSSLLLLLLLLLLLLRRRRRRRRRW
VVOQOOOOOOMMPPPPPVVVVVVVSSSSSSSSBSSSSSSDDDDDDDDDTLLLTTTLFFKKKKKKKKKDDZZZZZZDDDDDDDDDDEEEEEEEKKEKKKKLLLLLLLLLLLLNLLSSSLLLLLLLLLLLLRRRRRRRRRRW
VVOOOOOOOOMPPPPPPVVVHVVVSPSSSBBBBBSSSDDDDDDDDZDDTLLLLLLLLFFKKKKBBKKDDDDDDDDDDDDDDDDDDEEKEEKKKKKKKKKLLLLLLLLLLLLLLLSSSLLLLLLLLLLLRRRRRRRRRRRW
VVVOOOOOOOMPPPPPPPPVHPVSSPSSSSBBBBBBBBCDDDDZZZZLLLLLLLLLLFFVVVVVDDDDDDDDDDDDDDDDDDDDKKKKKKKKKKKKKKFLLLLLLLLLLLLLLLLLSSSLLLLLYLDRRRRRRRRRWWWW
VVVVOOOOOOSPPPPPPPPVVPEPPPSSSBBBBBBBBBLDLMLLZZLLLLLLLLLVVVVVVVVVVDDDDDDDDDDDDDGDDDDDDKKKKKKKKKKKKFFFIIOLLLLLLLLLLLLLLSSSLLYYYYRRRZZRRRRRRWWW
VVVOOVOOOOOPPPPPPPPPPPPPPPSSBBBBBBBBBBLLLLLLZLLLLLLLLLLVVVVVVVVVVDDDDDDDDDDGDDDDDDDFDKKKKPPKKKKKKFFFFIOLLLLLLLLLLLLLLSSSLKYYRRRRFFZKZZDDZZZZ
VVVOOVVVVOPPPPPOPPPPPPPPZPSSBBBBBBBBBBBLLLLLZZLLLLLLLLLVVVVVVVVVVVDDDDDDDDDDDDDDHFFFFKPPPPPPPPPPPFFFFLLLLLLLLLLLLLLLLSSSKKYYYRRFFFZKZZDZZZZZ
VVVVVVOOOOOOOOOOOPPPPPPPZZSBBBBBBBBBBBLLLLLLLLLLLLLLLLVVVVVVVVVVVDDDDDDDDDDDDDLUUFFFFFPPPIIIIIPPPFFFFFFLLLLLLLLLLLLLSSSKKKKKYKRFFZZZZZZZZZZZ
VVVVOVVOOOOOOOOWOPPPPPPPPPSSIIIIIIIIBBLLLLLLLLLLLLLLLVVVVVVVVVVVVDDDDDDDDUUDDUUUUUUUFFPPPIIIIIPPPFFFFFFLLLLLLRRRRLSSSKKKKKPKKKFFZZZZZZZZZZZZ
VVOOOOOOOOOOOOOOOOSPPPPPPSSSIIIIIIIIBLLLLLLLLLLLLLLLLVVVVVVVVVSSSDDDDDDDUUUDDUUUUUUIIIIIIIIIIIPPPFFFFFFRRLLLLRRRRSSSSKYKKKKKKKFZZZZZZZZZZZZZ
OOOOOOOOOOOOOOOOSSSPPPPSSSSSIIIIIIIIBLLLLLLLLLLLLLLLLLFVVVVVVVSSDDDDRRRDUUUUUUUUUIIIIIIIIIIIIIPHPFFFFFRRRLLRRRRSSSSSSSKKKKKKKFFZZZZZZZZZZZZZ
LOOOOOOOOOOOOOOSSSSSPSSSSSSSIIIIIIIIBLLLLLLLLLLLLLLLLLVVVVVVVVSSSSDRRRRUUUUUUUUUUIIIIIIIIIIIIIPPPPFFFFFRRRRRRRRRSSSKKKKKKKKKKZZZZZZZZZZZZZZZ
OOOOOOOOOOOOOOOSSSSSPSSSSSSSIIIIIIIIBBNNNNLLLLLLLLLLLLVVVVVVVVSRRSDRRRRRUWUUUUUUUIIIIIIIIIIIIIPPPPFFFFFFRRRRRRRRSSSSKKKKKKIJJYZZZZZZZZZZZZZZ
OOOOOOOOOOOOOOOOSSSSSSSSSSSSIIIIIIIINNNNNNLLLLLULHLLLLVVVVVVVVRRRRRRRRRUUWWUUUUUUIIIIIIIIIIIIIPPPPPFFFRRRRRRRRRRSSSSKKKKJJJJJYZZZEPZZZZZZZZZ
OOOOOOOOOOOOOOOOGGSSSSSSSSSSIIIIIIIINNNNNNLLLLLLHHHHHHVVVVVVVDFRRRRRRRRRRWWUUUUUUIIIIIIIIIIIIISSSXSFFFRRRRRRRRRRRRJKKKKKKJJJJJPPPPPZZPZZZZZZ
OOOOOOOOOOOOOOOOGGSSSSSSSSSSSSBBBBBBNNNNBNNLLLLLHHHHHVVVVLDZVDFRGRRRRWWWWWWUUWUUUUUIIIIIIIIIIIPPSSSFFFRRRRRRRRRRRJJKKKKKJJJJJJPPPPPPPPPPPZZZ
OOOOOOOOOOOOONGGGGGSSSSSSSSSSSBQBBBBBNNNBBBLLLLLBHHHVVVVVDDDDDDDRRRWWWWWWNWWWWWWUUVUUVPPPPPPPPPSSSSSFFRRRRRRRRRNRJKKJJJKJJJJJHPPPPPPPPPPPPPZ
OOOOOOOOOOOOOODGGGGGSSSSSSMMMMMMBBBOBBNNBBBBBLLBBBBBVVVVVDDDDDDDRRRKWWWWWWWWWVVVVUVVVVUPPPPPPPPSSSSSWRRRRRRRRRRRRJJJJJJJJJJJJPPPPPPPPPPPPPPP
OOOOOOOOGGLLGGGGGGGGGGGSMMMMMMMOOOOOBBNNBBBBBBBBRBBDVVVVVDDDDDWWWWWWWWWWWWWWWWWWVUVVVVUUPPPSPPSSSSSSSSSRRRRRRRRJJJJJJJJJJJJUUIUPPPPPPPPPPPPP
OOOOOGGGGGGGGGGGGGGGGMSSMMMMMMMMOOBBBBBBBBBBBBBBBBBDDDVDDDDDDDGWWWWWWWWWWWWWWWWVVVVVVVUUPPPSSSSSSSSSSSSRRRAAARRJJJJJJJJJJJUUUUUUPPPPPPPPPPPF
OOOOGGGGGGGGGGGGGGGGGMMSMMMMMMMMOOMMBBBBBBBBBBBBBBBDDDDDDDDDDGGGGGWWWWWWWWWWWVWVVVVVVVUUUPSSSSSSSSSSSSSRAAAAAJJJJJJJJJJJJJUUUUUPPPPPPPPPPPPP
OOOOGGGGGGGGGGGGGGGGGMMMMMMMMMMMMMMMBBBBBBBBBBBBBBBBDDDUUUDDDGGGGGWWWWWWWWWWWVVVVVVVVVUUUUCSSSSSSSSSSSSSSAAAAJJJJJJJJJJJJJUUUUUPPPPPPPPPPPPP
OOOOGGGGGGGGGGGGGGGGGMMMMMMMMMMMMMMBBBBBBBBBBBBBBBBBBUDDUUUDDGGGGWWWWWWWWWWWWWVVVVVVVVUUUUSNSSSSSSSSSSSSSSSAXJJJJJJJJJJJJUUUUUUPPPPPPPPPPPPP
OOOOGOGGGGGGGGGGGGGGGMMMMMMMMMMMMMBBBBBBBBBBBBBBBBBPUUUUUUNUDGGGGGWWWWWWWWWWWVVVVVVVVVUUUUSNSSSSSSSSSSSSDSSXXJJJJJJJJJJJJUJJUUPPPPPPPPPPPPPP
OOOOGOGGGGGGGGGGGGGGGMMMMMMMMMMMMBBBBBBBBBBBBBBBBBBPPPUUUUUUUGGGGGWGWWWWWWWWWVVVVVVVVVVVUUSSSSSSSSSSSSXSSXXXXJJJJJJJJJJJJJJJUUUPPPPPPPPPPPPP
OOOOOOOOGGGGGGGGGGGGGMOMMMMWMMMCMBBBBBBBBBBBBBBBBBPPPUULUUUGGGGGGGGGGWIIIWGWVVVVVVVVVVVVUUYYSSSHSSSSTSXXXXXXXXXJJJJJJJJJJJUUUUPPPPPPPPPPPPPP""".splitlines()

# data = """AAAA
# BBCD
# BBCC
# EEEC""".splitlines()

# data = """EEEEE
# EXXXX
# EEEEE
# EXXXX
# EEEEE""".splitlines()

# data = """AAAAAA
# AAABBA
# AAABBA
# ABBAAA
# ABBAAA
# AAAAAA""".splitlines()

# data = """OOOOO
# OXOXO
# OOOOO
# OXOXO
# OOOOO""".splitlines()

# data = """RRRRIICCFF
# RRRRIICCCF
# VVRRRCCFFF
# VVRCCCJFFF
# VVVVCJJCFE
# VVIVCCJJEE
# VVIIICJJEE
# MIIIIIJJEE
# MIIISIJEEE
# MMMISSJEEE""".splitlines()

from collections import deque

# function to check if a square is in the grid or not
def inGrid(sq):
    return 0 <= sq[0] < len(data) and 0 <= sq[1] < len(data[0])

# calculate groups
notVisited = set()
for r in range(len(data)):
    for c in range(len(data[0])):
        notVisited.add((r, c))
groups = {}
while notVisited:
    queue = deque([head := list(notVisited)[0]])
    groups[head] = set()
    while queue:
        curr = queue.popleft()
        if curr in notVisited:
            groups[head].add(curr)
            notVisited.remove(curr)
            for dr, dc in ((-1, 0), (1, 0), (0, -1), (0, 1)):
                nextsq = (curr[0]+dr, curr[1]+dc)
                if inGrid(nextsq) and data[curr[0]][curr[1]] == data[nextsq[0]][nextsq[1]]:
                    queue.append(nextsq)

# calculate area
areas = {gp : len(sqs) for gp, sqs in groups.items()}

# function to check if we can remove an edge (occurs when the two squares either side of it are part of the same group)
def canRemove(edge):
    start, end = edge
    if start[0] == end[0]: # same row - horizontal
        above, below = (start[0]-1, start[1]), start
        if inGrid(above) and inGrid(below):
            return data[above[0]][above[1]] == data[below[0]][below[1]]
        else:
            return False
    else: # same column - vertical
        left, right = (start[0], start[1]-1), start
        if inGrid(left) and inGrid(right):
            return data[left[0]][left[1]] == data[right[0]][right[1]]
        else:
            return False

# check if two squares have the same value, and return True if they aren't on the grid
def checkSameVal(sq1, sq2):
    if inGrid(sq1) and inGrid(sq2):
        return data[sq1[0]][sq1[1]] == data[sq2[0]][sq2[1]]
    return True

# check if two edges can be joined together by checking if at least one side is contiguous in character
def checkAdjacent(sq1, sq2, horiz):
    if horiz:
        ep1, ep2 = (sq1[0]-1, sq1[1]), (sq2[0]-1, sq2[1])
    else:
        ep1, ep2 = (sq1[0], sq1[1]-1), (sq2[0], sq2[1]-1)
    return checkSameVal(sq1, sq2) or checkSameVal(ep1, ep2)

# function that gets the next edge to add, whilst combining edges to form a side
def getNextEdgeToAdd(edge, edges, gp):
    start, end = edge
    if start[0] == end[0]: # same row - horizontal
        for e in edges[gp]:
            a, b = e
            if a[0] == b[0] and e != edge and a[0] == start[0]: # horizontal, different edge on same row
                if b[1] == start[1] and checkAdjacent((b[0],b[1]-1), start, True):
                    edges[gp].remove(e)
                    return (a, end)
                elif a[1] == end[1] and checkAdjacent((a[0],a[1]-1), end, True):
                    edges[gp].remove(e)
                    return (start, b)
    else: # same column - vertical
        for e in edges[gp]:
            a, b = e
            if a[1] == b[1] and e != edge and a[1] == start[1]: # vertical, different edge on same column
                if b[0] == start[0] and checkAdjacent((b[0]-1,b[1]), start, False):
                    edges[gp].remove(e)
                    return (a, end)
                elif a[0] == end[0] and checkAdjacent((a[0]-1,a[1]), end, False):
                    edges[gp].remove(e)
                    return (start, b)
    return edge

# calculate edges that make up the perimeter
edges = {}
for gp, sqs in groups.items():
    edges[gp] = set()
    for sq in sqs:
        r, c = sq
        char = data[r][c]
        for edge in [((r, c), (r, c+1)), ((r, c), (r+1, c)), ((r+1, c), (r+1, c+1)), ((r, c+1), (r+1, c+1))]:
            if not canRemove(edge): # if we cannot remove this edge
                newEdge = getNextEdgeToAdd(edge, edges, gp) # get the edge
                curr = edge
                while newEdge != curr: # if we have changed the edge we were going to insert
                    curr = newEdge
                    newEdge = getNextEdgeToAdd(curr, edges, gp) # keep doing this until we merge all edges into a side
                edges[gp].add(newEdge) # finally add the side

# calculate price
perims = {k : len(v) for k, v in edges.items()}
price = sum([a * perims[k] for k, a in areas.items()])
print(price)